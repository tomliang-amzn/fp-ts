"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ap = ap;
exports.chain = chain;
exports.evaluate = evaluate;
exports.execute = execute;
exports.fromF = fromF;
exports.fromState = fromState;
exports.getStateM = getStateM;
exports.map = map;
exports.of = of;

var _function = require("./function");

var _ReadonlyTuple = require("./ReadonlyTuple");

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function of(F) {
  return function (a) {
    return function (s) {
      return F.of([a, s]);
    };
  };
}
/**
 * @since 2.10.0
 */


function map(F) {
  return function (f) {
    return function (fa) {
      return function (s) {
        return F.map(fa(s), function (_ref) {
          var _ref2 = _slicedToArray(_ref, 2),
              a = _ref2[0],
              s1 = _ref2[1];

          return [f(a), s1];
        });
      };
    };
  };
}
/**
 * @since 2.10.0
 */


function ap(M) {
  return function (fa) {
    return function (fab) {
      return function (s) {
        return M.chain(fab(s), function (_ref3) {
          var _ref4 = _slicedToArray(_ref3, 2),
              f = _ref4[0],
              s = _ref4[1];

          return M.map(fa(s), function (_ref5) {
            var _ref6 = _slicedToArray(_ref5, 2),
                a = _ref6[0],
                s = _ref6[1];

            return [f(a), s];
          });
        });
      };
    };
  };
}
/**
 * @since 2.10.0
 */


function chain(M) {
  return function (f) {
    return function (ma) {
      return function (s) {
        return M.chain(ma(s), function (_ref7) {
          var _ref8 = _slicedToArray(_ref7, 2),
              a = _ref8[0],
              s1 = _ref8[1];

          return f(a)(s1);
        });
      };
    };
  };
}
/**
 * @since 2.10.0
 */


function fromState(F) {
  return function (sa) {
    return function (s) {
      return F.of(sa(s));
    };
  };
}
/**
 * @since 2.10.0
 */


function fromF(F) {
  return function (ma) {
    return function (s) {
      return F.map(ma, function (a) {
        return [a, s];
      });
    };
  };
}
/**
 * @since 2.10.0
 */


function evaluate(F) {
  return function (s) {
    return function (ma) {
      return F.map(ma(s), function (_ref9) {
        var _ref10 = _slicedToArray(_ref9, 1),
            a = _ref10[0];

        return a;
      });
    };
  };
}
/**
 * @since 2.10.0
 */


function execute(F) {
  return function (s) {
    return function (ma) {
      return F.map(ma(s), _ReadonlyTuple.snd);
    };
  };
} // -------------------------------------------------------------------------------------
// deprecated
// -------------------------------------------------------------------------------------
// tslint:disable: deprecation

/**
 * @since 2.0.0
 * @deprecated
 */


/** @deprecated */

/* istanbul ignore next */
function getStateM(M) {
  var _ap = ap(M);

  var _map = map(M);

  var _chain = chain(M);

  var _evaluate = evaluate(M);

  var _execute = execute(M);

  return {
    map: function map(fa, f) {
      return (0, _function.pipe)(fa, _map(f));
    },
    ap: function ap(fab, fa) {
      return (0, _function.pipe)(fab, _ap(fa));
    },
    of: of(M),
    chain: function chain(ma, f) {
      return (0, _function.pipe)(ma, _chain(f));
    },
    get: function get() {
      return function (s) {
        return M.of([s, s]);
      };
    },
    put: function put(s) {
      return function () {
        return M.of([undefined, s]);
      };
    },
    modify: function modify(f) {
      return function (s) {
        return M.of([undefined, f(s)]);
      };
    },
    gets: function gets(f) {
      return function (s) {
        return M.of([f(s), s]);
      };
    },
    fromState: fromState(M),
    fromM: fromF(M),
    evalState: function evalState(fa, s) {
      return (0, _function.pipe)(fa, _evaluate(s));
    },
    execState: function execState(fa, s) {
      return (0, _function.pipe)(fa, _execute(s));
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mcC10cy9TdGF0ZVQudHMiXSwibmFtZXMiOlsib2YiLCJGIiwiYSIsInMiLCJtYXAiLCJmIiwiZmEiLCJzMSIsImFwIiwiTSIsImZhYiIsImNoYWluIiwibWEiLCJmcm9tU3RhdGUiLCJzYSIsImZyb21GIiwiZXZhbHVhdGUiLCJleGVjdXRlIiwic25kIiwiZ2V0U3RhdGVNIiwiX2FwIiwiX21hcCIsIl9jaGFpbiIsIl9ldmFsdWF0ZSIsIl9leGVjdXRlIiwiZ2V0IiwicHV0IiwidW5kZWZpbmVkIiwibW9kaWZ5IiwiZ2V0cyIsImZyb21NIiwiZXZhbFN0YXRlIiwiZXhlY1N0YXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFJQTs7QUFLQTs7Ozs7Ozs7Ozs7Ozs7QUE0Q08sU0FBU0EsRUFBVCxDQUFlQyxDQUFmLEVBQStEO0FBQ3BFLFNBQU8sVUFBQ0MsQ0FBRDtBQUFBLFdBQU8sVUFBQ0MsQ0FBRDtBQUFBLGFBQU9GLENBQUMsQ0FBQ0QsRUFBRixDQUFLLENBQUNFLENBQUQsRUFBSUMsQ0FBSixDQUFMLENBQVA7QUFBQSxLQUFQO0FBQUEsR0FBUDtBQUNEO0FBRUQ7QUFDQTtBQUNBOzs7QUFpQk8sU0FBU0MsR0FBVCxDQUFnQkgsQ0FBaEIsRUFBc0c7QUFDM0csU0FBTyxVQUFDSSxDQUFEO0FBQUEsV0FBTyxVQUFDQyxFQUFEO0FBQUEsYUFBUSxVQUFDSCxDQUFEO0FBQUEsZUFBT0YsQ0FBQyxDQUFDRyxHQUFGLENBQU1FLEVBQUUsQ0FBQ0gsQ0FBRCxDQUFSLEVBQWE7QUFBQTtBQUFBLGNBQUVELENBQUY7QUFBQSxjQUFLSyxFQUFMOztBQUFBLGlCQUFhLENBQUNGLENBQUMsQ0FBQ0gsQ0FBRCxDQUFGLEVBQU9LLEVBQVAsQ0FBYjtBQUFBLFNBQWIsQ0FBUDtBQUFBLE9BQVI7QUFBQSxLQUFQO0FBQUEsR0FBUDtBQUNEO0FBRUQ7QUFDQTtBQUNBOzs7QUFtQk8sU0FBU0MsRUFBVCxDQUNMQyxDQURLLEVBRWtGO0FBQ3ZG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LENBQUMsQ0FBQ1QsRUFBRixDQUFLLENBQUNLLENBQUMsQ0FBQ0YsQ0FBRCxDQUFGLEVBQU9BLENBQVAsQ0FBTCxDQUFQO0FBQUEsT0FBUDtBQUFBLEtBUkQ7QUFTTFUsSUFBQUEsU0FBUyxFQUFFQSxTQUFTLENBQUNKLENBQUQsQ0FUZjtBQVVMcUIsSUFBQUEsS0FBSyxFQUFFZixLQUFLLENBQUNOLENBQUQsQ0FWUDtBQVdMc0IsSUFBQUEsU0FBUyxFQUFFLG1CQUFDekIsRUFBRCxFQUFLSCxDQUFMO0FBQUEsYUFBVyxvQkFBS0csRUFBTCxFQUFTaUIsU0FBUyxDQUFDcEIsQ0FBRCxDQUFsQixDQUFYO0FBQUEsS0FYTjtBQVlMNkIsSUFBQUEsU0FBUyxFQUFFLG1CQUFDMUIsRUFBRCxFQUFLSCxDQUFMO0FBQUEsYUFBVyxvQkFBS0csRUFBTCxFQUFTa0IsUUFBUSxDQUFDckIsQ0FBRCxDQUFqQixDQUFYO0FBQUE7QUFaTixHQUFQO0FBY0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5pbXBvcnQgeyBDaGFpbiwgQ2hhaW4xLCBDaGFpbjIsIENoYWluMkMsIENoYWluMywgQ2hhaW4zQyB9IGZyb20gJy4vQ2hhaW4nXG5pbXBvcnQgeyBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbidcbmltcG9ydCB7IEZ1bmN0b3IsIEZ1bmN0b3IxLCBGdW5jdG9yMiwgRnVuY3RvcjJDLCBGdW5jdG9yMywgRnVuY3RvcjNDIH0gZnJvbSAnLi9GdW5jdG9yJ1xuaW1wb3J0IHsgSEtULCBLaW5kLCBLaW5kMiwgS2luZDMsIFVSSVMsIFVSSVMyLCBVUklTMyB9IGZyb20gJy4vSEtUJ1xuaW1wb3J0IHsgTW9uYWQsIE1vbmFkMSwgTW9uYWQyLCBNb25hZDJDLCBNb25hZDMsIE1vbmFkM0MgfSBmcm9tICcuL01vbmFkJ1xuaW1wb3J0IHsgUG9pbnRlZCwgUG9pbnRlZDEsIFBvaW50ZWQyLCBQb2ludGVkMkMsIFBvaW50ZWQzLCBQb2ludGVkM0MgfSBmcm9tICcuL1BvaW50ZWQnXG5pbXBvcnQgeyBzbmQgfSBmcm9tICcuL1JlYWRvbmx5VHVwbGUnXG5pbXBvcnQgeyBTdGF0ZSB9IGZyb20gJy4vU3RhdGUnXG5cbi8qKlxuICogQGNhdGVnb3J5IG1vZGVsXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTdGF0ZVQ8TSwgUywgQT4ge1xuICAoczogUyk6IEhLVDxNLCBbQSwgU10+XG59XG5cbi8qKlxuICogQGNhdGVnb3J5IG1vZGVsXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTdGF0ZVQxPE0gZXh0ZW5kcyBVUklTLCBTLCBBPiB7XG4gIChzOiBTKTogS2luZDxNLCBbQSwgU10+XG59XG5cbi8qKlxuICogQGNhdGVnb3J5IG1vZGVsXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTdGF0ZVQyPE0gZXh0ZW5kcyBVUklTMiwgUywgRSwgQT4ge1xuICAoczogUyk6IEtpbmQyPE0sIEUsIFtBLCBTXT5cbn1cblxuLyoqXG4gKiBAY2F0ZWdvcnkgbW9kZWxcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRlVDM8TSBleHRlbmRzIFVSSVMzLCBTLCBSLCBFLCBBPiB7XG4gIChzOiBTKTogS2luZDM8TSwgUiwgRSwgW0EsIFNdPlxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9mPEYgZXh0ZW5kcyBVUklTMz4oRjogUG9pbnRlZDM8Rj4pOiA8QSwgUywgUiwgRT4oYTogQSkgPT4gU3RhdGVUMzxGLCBTLCBSLCBFLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIG9mPEYgZXh0ZW5kcyBVUklTMywgRT4oRjogUG9pbnRlZDNDPEYsIEU+KTogPEEsIFMsIFI+KGE6IEEpID0+IFN0YXRlVDM8RiwgUywgUiwgRSwgQT5cbmV4cG9ydCBmdW5jdGlvbiBvZjxGIGV4dGVuZHMgVVJJUzI+KEY6IFBvaW50ZWQyPEY+KTogPEEsIFMsIEU+KGE6IEEpID0+IFN0YXRlVDI8RiwgUywgRSwgQT5cbmV4cG9ydCBmdW5jdGlvbiBvZjxGIGV4dGVuZHMgVVJJUzIsIEU+KEY6IFBvaW50ZWQyQzxGLCBFPik6IDxBLCBTPihhOiBBKSA9PiBTdGF0ZVQyPEYsIFMsIEUsIEE+XG5leHBvcnQgZnVuY3Rpb24gb2Y8RiBleHRlbmRzIFVSSVM+KEY6IFBvaW50ZWQxPEY+KTogPEEsIFM+KGE6IEEpID0+IFN0YXRlVDE8RiwgUywgQT5cbmV4cG9ydCBmdW5jdGlvbiBvZjxGPihGOiBQb2ludGVkPEY+KTogPEEsIFM+KGE6IEEpID0+IFN0YXRlVDxGLCBTLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIG9mPEY+KEY6IFBvaW50ZWQ8Rj4pOiA8QSwgUz4oYTogQSkgPT4gU3RhdGVUPEYsIFMsIEE+IHtcbiAgcmV0dXJuIChhKSA9PiAocykgPT4gRi5vZihbYSwgc10pXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwPEYgZXh0ZW5kcyBVUklTMz4oXG4gIEY6IEZ1bmN0b3IzPEY+XG4pOiA8QSwgQj4oZjogKGE6IEEpID0+IEIpID0+IDxTLCBSLCBFPihmYTogU3RhdGVUMzxGLCBTLCBSLCBFLCBBPikgPT4gU3RhdGVUMzxGLCBTLCBSLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIG1hcDxGIGV4dGVuZHMgVVJJUzMsIEU+KFxuICBGOiBGdW5jdG9yM0M8RiwgRT5cbik6IDxBLCBCPihmOiAoYTogQSkgPT4gQikgPT4gPFMsIFI+KGZhOiBTdGF0ZVQzPEYsIFMsIFIsIEUsIEE+KSA9PiBTdGF0ZVQzPEYsIFMsIFIsIEUsIEI+XG5leHBvcnQgZnVuY3Rpb24gbWFwPEYgZXh0ZW5kcyBVUklTMj4oXG4gIEY6IEZ1bmN0b3IyPEY+XG4pOiA8QSwgQj4oZjogKGE6IEEpID0+IEIpID0+IDxTLCBFPihmYTogU3RhdGVUMjxGLCBTLCBFLCBBPikgPT4gU3RhdGVUMjxGLCBTLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIG1hcDxGIGV4dGVuZHMgVVJJUzIsIEU+KFxuICBGOiBGdW5jdG9yMkM8RiwgRT5cbik6IDxBLCBCPihmOiAoYTogQSkgPT4gQikgPT4gPFM+KGZhOiBTdGF0ZVQyPEYsIFMsIEUsIEE+KSA9PiBTdGF0ZVQyPEYsIFMsIEUsIEI+XG5leHBvcnQgZnVuY3Rpb24gbWFwPEYgZXh0ZW5kcyBVUklTPihcbiAgRjogRnVuY3RvcjE8Rj5cbik6IDxBLCBCPihmOiAoYTogQSkgPT4gQikgPT4gPFM+KGZhOiBTdGF0ZVQxPEYsIFMsIEE+KSA9PiBTdGF0ZVQxPEYsIFMsIEI+XG5leHBvcnQgZnVuY3Rpb24gbWFwPEY+KEY6IEZ1bmN0b3I8Rj4pOiA8QSwgQj4oZjogKGE6IEEpID0+IEIpID0+IDxTPihmYTogU3RhdGVUPEYsIFMsIEE+KSA9PiBTdGF0ZVQ8RiwgUywgQj5cbmV4cG9ydCBmdW5jdGlvbiBtYXA8Rj4oRjogRnVuY3RvcjxGPik6IDxBLCBCPihmOiAoYTogQSkgPT4gQikgPT4gPFM+KGZhOiBTdGF0ZVQ8RiwgUywgQT4pID0+IFN0YXRlVDxGLCBTLCBCPiB7XG4gIHJldHVybiAoZikgPT4gKGZhKSA9PiAocykgPT4gRi5tYXAoZmEocyksIChbYSwgczFdKSA9PiBbZihhKSwgczFdKVxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwPE0gZXh0ZW5kcyBVUklTMz4oXG4gIE06IENoYWluMzxNPlxuKTogPFMsIFIsIEUsIEE+KGZhOiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEE+KSA9PiA8Qj4oZmFiOiBTdGF0ZVQzPE0sIFMsIFIsIEUsIChhOiBBKSA9PiBCPikgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIGFwPE0gZXh0ZW5kcyBVUklTMywgRT4oXG4gIE06IENoYWluM0M8TSwgRT5cbik6IDxTLCBSLCBBPihmYTogU3RhdGVUMzxNLCBTLCBSLCBFLCBBPikgPT4gPEI+KGZhYjogU3RhdGVUMzxNLCBTLCBSLCBFLCAoYTogQSkgPT4gQj4pID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQj5cbmV4cG9ydCBmdW5jdGlvbiBhcDxNIGV4dGVuZHMgVVJJUzI+KFxuICBNOiBDaGFpbjI8TT5cbik6IDxTLCBFLCBBPihmYTogU3RhdGVUMjxNLCBTLCBFLCBBPikgPT4gPEI+KGZhYjogU3RhdGVUMjxNLCBTLCBFLCAoYTogQSkgPT4gQj4pID0+IFN0YXRlVDI8TSwgUywgRSwgQj5cbmV4cG9ydCBmdW5jdGlvbiBhcDxNIGV4dGVuZHMgVVJJUzIsIEU+KFxuICBNOiBDaGFpbjJDPE0sIEU+XG4pOiA8UywgQT4oZmE6IFN0YXRlVDI8TSwgUywgRSwgQT4pID0+IDxCPihmYWI6IFN0YXRlVDI8TSwgUywgRSwgKGE6IEEpID0+IEI+KSA9PiBTdGF0ZVQyPE0sIFMsIEUsIEI+XG5leHBvcnQgZnVuY3Rpb24gYXA8TSBleHRlbmRzIFVSSVM+KFxuICBNOiBDaGFpbjE8TT5cbik6IDxTLCBBPihmYTogU3RhdGVUMTxNLCBTLCBBPikgPT4gPEI+KGZhYjogU3RhdGVUMTxNLCBTLCAoYTogQSkgPT4gQj4pID0+IFN0YXRlVDE8TSwgUywgQj5cbmV4cG9ydCBmdW5jdGlvbiBhcDxNPihcbiAgTTogQ2hhaW48TT5cbik6IDxTLCBBPihmYTogU3RhdGVUPE0sIFMsIEE+KSA9PiA8Qj4oZmFiOiBTdGF0ZVQ8TSwgUywgKGE6IEEpID0+IEI+KSA9PiBTdGF0ZVQ8TSwgUywgQj5cbmV4cG9ydCBmdW5jdGlvbiBhcDxNPihcbiAgTTogQ2hhaW48TT5cbik6IDxTLCBBPihmYTogU3RhdGVUPE0sIFMsIEE+KSA9PiA8Qj4oZmFiOiBTdGF0ZVQ8TSwgUywgKGE6IEEpID0+IEI+KSA9PiBTdGF0ZVQ8TSwgUywgQj4ge1xuICByZXR1cm4gKGZhKSA9PiAoZmFiKSA9PiAocykgPT4gTS5jaGFpbihmYWIocyksIChbZiwgc10pID0+IE0ubWFwKGZhKHMpLCAoW2EsIHNdKSA9PiBbZihhKSwgc10pKVxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNoYWluPE0gZXh0ZW5kcyBVUklTMz4oXG4gIE06IENoYWluMzxNPlxuKTogPEEsIFMsIFIsIEUsIEI+KGY6IChhOiBBKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+KSA9PiAobWE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4pID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQj5cbmV4cG9ydCBmdW5jdGlvbiBjaGFpbjxNIGV4dGVuZHMgVVJJUzMsIEU+KFxuICBNOiBDaGFpbjNDPE0sIEU+XG4pOiA8QSwgUywgUiwgQj4oZjogKGE6IEEpID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQj4pID0+IChtYTogU3RhdGVUMzxNLCBTLCBSLCBFLCBBPikgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluPE0gZXh0ZW5kcyBVUklTMj4oXG4gIE06IENoYWluMjxNPlxuKTogPEEsIFMsIEUsIEI+KGY6IChhOiBBKSA9PiBTdGF0ZVQyPE0sIFMsIEUsIEI+KSA9PiAobWE6IFN0YXRlVDI8TSwgUywgRSwgQT4pID0+IFN0YXRlVDI8TSwgUywgRSwgQj5cbmV4cG9ydCBmdW5jdGlvbiBjaGFpbjxNIGV4dGVuZHMgVVJJUzIsIEU+KFxuICBNOiBDaGFpbjJDPE0sIEU+XG4pOiA8QSwgUywgQj4oZjogKGE6IEEpID0+IFN0YXRlVDI8TSwgUywgRSwgQj4pID0+IChtYTogU3RhdGVUMjxNLCBTLCBFLCBBPikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluPE0gZXh0ZW5kcyBVUklTPihcbiAgTTogQ2hhaW4xPE0+XG4pOiA8QSwgUywgQj4oZjogKGE6IEEpID0+IFN0YXRlVDE8TSwgUywgQj4pID0+IChtYTogU3RhdGVUMTxNLCBTLCBBPikgPT4gU3RhdGVUMTxNLCBTLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluPE0+KFxuICBNOiBDaGFpbjxNPlxuKTogPEEsIFMsIEI+KGY6IChhOiBBKSA9PiBTdGF0ZVQ8TSwgUywgQj4pID0+IChtYTogU3RhdGVUPE0sIFMsIEE+KSA9PiBTdGF0ZVQ8TSwgUywgQj5cbmV4cG9ydCBmdW5jdGlvbiBjaGFpbjxNPihcbiAgTTogQ2hhaW48TT5cbik6IDxBLCBTLCBCPihmOiAoYTogQSkgPT4gU3RhdGVUPE0sIFMsIEI+KSA9PiAobWE6IFN0YXRlVDxNLCBTLCBBPikgPT4gU3RhdGVUPE0sIFMsIEI+IHtcbiAgcmV0dXJuIChmKSA9PiAobWEpID0+IChzKSA9PiBNLmNoYWluKG1hKHMpLCAoW2EsIHMxXSkgPT4gZihhKShzMSkpXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbVN0YXRlPEYgZXh0ZW5kcyBVUklTMz4oRjogUG9pbnRlZDM8Rj4pOiA8UywgQSwgUiwgRT4oc2E6IFN0YXRlPFMsIEE+KSA9PiBTdGF0ZVQzPEYsIFMsIFIsIEUsIEE+XG5leHBvcnQgZnVuY3Rpb24gZnJvbVN0YXRlPEYgZXh0ZW5kcyBVUklTMywgRT4oRjogUG9pbnRlZDNDPEYsIEU+KTogPFMsIEEsIFI+KHNhOiBTdGF0ZTxTLCBBPikgPT4gU3RhdGVUMzxGLCBTLCBSLCBFLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIGZyb21TdGF0ZTxGIGV4dGVuZHMgVVJJUzI+KEY6IFBvaW50ZWQyPEY+KTogPFMsIEEsIEU+KHNhOiBTdGF0ZTxTLCBBPikgPT4gU3RhdGVUMjxGLCBTLCBFLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIGZyb21TdGF0ZTxGIGV4dGVuZHMgVVJJUzIsIEU+KEY6IFBvaW50ZWQyQzxGLCBFPik6IDxTLCBBPihzYTogU3RhdGU8UywgQT4pID0+IFN0YXRlVDI8RiwgUywgRSwgQT5cbmV4cG9ydCBmdW5jdGlvbiBmcm9tU3RhdGU8RiBleHRlbmRzIFVSSVM+KEY6IFBvaW50ZWQxPEY+KTogPFMsIEE+KHNhOiBTdGF0ZTxTLCBBPikgPT4gU3RhdGVUMTxGLCBTLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIGZyb21TdGF0ZTxGPihGOiBQb2ludGVkPEY+KTogPFMsIEE+KHNhOiBTdGF0ZTxTLCBBPikgPT4gU3RhdGVUPEYsIFMsIEE+XG5leHBvcnQgZnVuY3Rpb24gZnJvbVN0YXRlPEY+KEY6IFBvaW50ZWQ8Rj4pOiA8UywgQT4oc2E6IFN0YXRlPFMsIEE+KSA9PiBTdGF0ZVQ8RiwgUywgQT4ge1xuICByZXR1cm4gKHNhKSA9PiAocykgPT4gRi5vZihzYShzKSlcbn1cblxuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tRjxGIGV4dGVuZHMgVVJJUzM+KEY6IEZ1bmN0b3IzPEY+KTogPFIsIEUsIEEsIFM+KG1hOiBLaW5kMzxGLCBSLCBFLCBBPikgPT4gU3RhdGVUMzxGLCBTLCBSLCBFLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIGZyb21GPEYgZXh0ZW5kcyBVUklTMywgRT4oXG4gIEY6IEZ1bmN0b3IzQzxGLCBFPlxuKTogPFIsIEEsIFM+KG1hOiBLaW5kMzxGLCBSLCBFLCBBPikgPT4gU3RhdGVUMzxGLCBTLCBSLCBFLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIGZyb21GPEYgZXh0ZW5kcyBVUklTMj4oRjogRnVuY3RvcjI8Rj4pOiA8RSwgQSwgUz4obWE6IEtpbmQyPEYsIEUsIEE+KSA9PiBTdGF0ZVQyPEYsIFMsIEUsIEE+XG5leHBvcnQgZnVuY3Rpb24gZnJvbUY8RiBleHRlbmRzIFVSSVMyLCBFPihGOiBGdW5jdG9yMkM8RiwgRT4pOiA8QSwgUz4obWE6IEtpbmQyPEYsIEUsIEE+KSA9PiBTdGF0ZVQyPEYsIFMsIEUsIEE+XG5leHBvcnQgZnVuY3Rpb24gZnJvbUY8RiBleHRlbmRzIFVSSVM+KEY6IEZ1bmN0b3IxPEY+KTogPEEsIFM+KG1hOiBLaW5kPEYsIEE+KSA9PiBTdGF0ZVQxPEYsIFMsIEE+XG5leHBvcnQgZnVuY3Rpb24gZnJvbUY8Rj4oRjogRnVuY3RvcjxGPik6IDxBLCBTPihtYTogSEtUPEYsIEE+KSA9PiBTdGF0ZVQ8RiwgUywgQT5cbmV4cG9ydCBmdW5jdGlvbiBmcm9tRjxGPihGOiBGdW5jdG9yPEY+KTogPEEsIFM+KG1hOiBIS1Q8RiwgQT4pID0+IFN0YXRlVDxGLCBTLCBBPiB7XG4gIHJldHVybiAobWEpID0+IChzKSA9PiBGLm1hcChtYSwgKGEpID0+IFthLCBzXSlcbn1cblxuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBldmFsdWF0ZTxGIGV4dGVuZHMgVVJJUzM+KFxuICBGOiBGdW5jdG9yMzxGPlxuKTogPFM+KHM6IFMpID0+IDxSLCBFLCBBPihtYTogU3RhdGVUMzxGLCBTLCBSLCBFLCBBPikgPT4gS2luZDM8RiwgUiwgRSwgQT5cbmV4cG9ydCBmdW5jdGlvbiBldmFsdWF0ZTxGIGV4dGVuZHMgVVJJUzMsIEU+KFxuICBGOiBGdW5jdG9yM0M8RiwgRT5cbik6IDxTPihzOiBTKSA9PiA8UiwgQT4obWE6IFN0YXRlVDM8RiwgUywgUiwgRSwgQT4pID0+IEtpbmQzPEYsIFIsIEUsIEE+XG5leHBvcnQgZnVuY3Rpb24gZXZhbHVhdGU8RiBleHRlbmRzIFVSSVMyPihcbiAgRjogRnVuY3RvcjI8Rj5cbik6IDxTPihzOiBTKSA9PiA8RSwgQT4obWE6IFN0YXRlVDI8RiwgUywgRSwgQT4pID0+IEtpbmQyPEYsIEUsIEE+XG5leHBvcnQgZnVuY3Rpb24gZXZhbHVhdGU8RiBleHRlbmRzIFVSSVMyLCBFPihcbiAgRjogRnVuY3RvcjJDPEYsIEU+XG4pOiA8Uz4oczogUykgPT4gPEE+KG1hOiBTdGF0ZVQyPEYsIFMsIEUsIEE+KSA9PiBLaW5kMjxGLCBFLCBBPlxuZXhwb3J0IGZ1bmN0aW9uIGV2YWx1YXRlPEYgZXh0ZW5kcyBVUklTPihGOiBGdW5jdG9yMTxGPik6IDxTPihzOiBTKSA9PiA8QT4obWE6IFN0YXRlVDE8RiwgUywgQT4pID0+IEtpbmQ8RiwgQT5cbmV4cG9ydCBmdW5jdGlvbiBldmFsdWF0ZTxGPihGOiBGdW5jdG9yPEY+KTogPFM+KHM6IFMpID0+IDxBPihtYTogU3RhdGVUPEYsIFMsIEE+KSA9PiBIS1Q8RiwgQT5cbmV4cG9ydCBmdW5jdGlvbiBldmFsdWF0ZTxGPihGOiBGdW5jdG9yPEY+KTogPFM+KHM6IFMpID0+IDxBPihtYTogU3RhdGVUPEYsIFMsIEE+KSA9PiBIS1Q8RiwgQT4ge1xuICByZXR1cm4gKHMpID0+IChtYSkgPT4gRi5tYXAobWEocyksIChbYV0pID0+IGEpXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhlY3V0ZTxGIGV4dGVuZHMgVVJJUzM+KFxuICBGOiBGdW5jdG9yMzxGPlxuKTogPFM+KHM6IFMpID0+IDxSLCBFLCBBPihtYTogU3RhdGVUMzxGLCBTLCBSLCBFLCBBPikgPT4gS2luZDM8RiwgUiwgRSwgUz5cbmV4cG9ydCBmdW5jdGlvbiBleGVjdXRlPEYgZXh0ZW5kcyBVUklTMywgRT4oXG4gIEY6IEZ1bmN0b3IzQzxGLCBFPlxuKTogPFM+KHM6IFMpID0+IDxSLCBBPihtYTogU3RhdGVUMzxGLCBTLCBSLCBFLCBBPikgPT4gS2luZDM8RiwgUiwgRSwgUz5cbmV4cG9ydCBmdW5jdGlvbiBleGVjdXRlPEYgZXh0ZW5kcyBVUklTMj4oRjogRnVuY3RvcjI8Rj4pOiA8Uz4oczogUykgPT4gPEUsIEE+KG1hOiBTdGF0ZVQyPEYsIFMsIEUsIEE+KSA9PiBLaW5kMjxGLCBFLCBTPlxuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGU8RiBleHRlbmRzIFVSSVMyLCBFPihcbiAgRjogRnVuY3RvcjJDPEYsIEU+XG4pOiA8Uz4oczogUykgPT4gPEE+KG1hOiBTdGF0ZVQyPEYsIFMsIEUsIEE+KSA9PiBLaW5kMjxGLCBFLCBTPlxuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGU8RiBleHRlbmRzIFVSSVM+KEY6IEZ1bmN0b3IxPEY+KTogPFM+KHM6IFMpID0+IDxBPihtYTogU3RhdGVUMTxGLCBTLCBBPikgPT4gS2luZDxGLCBTPlxuZXhwb3J0IGZ1bmN0aW9uIGV4ZWN1dGU8Rj4oRjogRnVuY3RvcjxGPik6IDxTPihzOiBTKSA9PiA8QT4obWE6IFN0YXRlVDxGLCBTLCBBPikgPT4gSEtUPEYsIFM+XG5leHBvcnQgZnVuY3Rpb24gZXhlY3V0ZTxGPihGOiBGdW5jdG9yPEY+KTogPFM+KHM6IFMpID0+IDxBPihtYTogU3RhdGVUPEYsIFMsIEE+KSA9PiBIS1Q8RiwgUz4ge1xuICByZXR1cm4gKHMpID0+IChtYSkgPT4gRi5tYXAobWEocyksIHNuZClcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyB0c2xpbnQ6ZGlzYWJsZTogZGVwcmVjYXRpb25cblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVNPE0+IHtcbiAgcmVhZG9ubHkgbWFwOiA8UywgQSwgQj4oZmE6IFN0YXRlVDxNLCBTLCBBPiwgZjogKGE6IEEpID0+IEIpID0+IFN0YXRlVDxNLCBTLCBCPlxuICByZWFkb25seSBvZjogPFMsIEE+KGE6IEEpID0+IFN0YXRlVDxNLCBTLCBBPlxuICByZWFkb25seSBhcDogPFMsIEEsIEI+KGZhYjogU3RhdGVUPE0sIFMsIChhOiBBKSA9PiBCPiwgZmE6IFN0YXRlVDxNLCBTLCBBPikgPT4gU3RhdGVUPE0sIFMsIEI+XG4gIHJlYWRvbmx5IGNoYWluOiA8UywgQSwgQj4oZmE6IFN0YXRlVDxNLCBTLCBBPiwgZjogKGE6IEEpID0+IFN0YXRlVDxNLCBTLCBCPikgPT4gU3RhdGVUPE0sIFMsIEI+XG4gIHJlYWRvbmx5IGdldDogPFM+KCkgPT4gU3RhdGVUPE0sIFMsIFM+XG4gIHJlYWRvbmx5IHB1dDogPFM+KHM6IFMpID0+IFN0YXRlVDxNLCBTLCB2b2lkPlxuICByZWFkb25seSBtb2RpZnk6IDxTPihmOiAoczogUykgPT4gUykgPT4gU3RhdGVUPE0sIFMsIHZvaWQ+XG4gIHJlYWRvbmx5IGdldHM6IDxTLCBBPihmOiAoczogUykgPT4gQSkgPT4gU3RhdGVUPE0sIFMsIEE+XG4gIHJlYWRvbmx5IGZyb21TdGF0ZTogPFMsIEE+KGZhOiBTdGF0ZTxTLCBBPikgPT4gU3RhdGVUPE0sIFMsIEE+XG4gIHJlYWRvbmx5IGZyb21NOiA8UywgQT4obWE6IEhLVDxNLCBBPikgPT4gU3RhdGVUPE0sIFMsIEE+XG4gIHJlYWRvbmx5IGV2YWxTdGF0ZTogPFMsIEE+KG1hOiBTdGF0ZVQ8TSwgUywgQT4sIHM6IFMpID0+IEhLVDxNLCBBPlxuICByZWFkb25seSBleGVjU3RhdGU6IDxTLCBBPihtYTogU3RhdGVUPE0sIFMsIEE+LCBzOiBTKSA9PiBIS1Q8TSwgUz5cbn1cblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVNMTxNIGV4dGVuZHMgVVJJUz4ge1xuICByZWFkb25seSBtYXA6IDxTLCBBLCBCPihmYTogU3RhdGVUMTxNLCBTLCBBPiwgZjogKGE6IEEpID0+IEIpID0+IFN0YXRlVDE8TSwgUywgQj5cbiAgcmVhZG9ubHkgb2Y6IDxTLCBBPihhOiBBKSA9PiBTdGF0ZVQxPE0sIFMsIEE+XG4gIHJlYWRvbmx5IGFwOiA8UywgQSwgQj4oZmFiOiBTdGF0ZVQxPE0sIFMsIChhOiBBKSA9PiBCPiwgZmE6IFN0YXRlVDE8TSwgUywgQT4pID0+IFN0YXRlVDE8TSwgUywgQj5cbiAgcmVhZG9ubHkgY2hhaW46IDxTLCBBLCBCPihmYTogU3RhdGVUMTxNLCBTLCBBPiwgZjogKGE6IEEpID0+IFN0YXRlVDE8TSwgUywgQj4pID0+IFN0YXRlVDE8TSwgUywgQj5cbiAgcmVhZG9ubHkgZ2V0OiA8Uz4oKSA9PiBTdGF0ZVQxPE0sIFMsIFM+XG4gIHJlYWRvbmx5IHB1dDogPFM+KHM6IFMpID0+IFN0YXRlVDE8TSwgUywgdm9pZD5cbiAgcmVhZG9ubHkgbW9kaWZ5OiA8Uz4oZjogKHM6IFMpID0+IFMpID0+IFN0YXRlVDE8TSwgUywgdm9pZD5cbiAgcmVhZG9ubHkgZ2V0czogPFMsIEE+KGY6IChzOiBTKSA9PiBBKSA9PiBTdGF0ZVQxPE0sIFMsIEE+XG4gIHJlYWRvbmx5IGZyb21TdGF0ZTogPFMsIEE+KGZhOiBTdGF0ZTxTLCBBPikgPT4gU3RhdGVUMTxNLCBTLCBBPlxuICByZWFkb25seSBmcm9tTTogPFMsIEE+KG1hOiBLaW5kPE0sIEE+KSA9PiBTdGF0ZVQxPE0sIFMsIEE+XG4gIHJlYWRvbmx5IGV2YWxTdGF0ZTogPFMsIEE+KG1hOiBTdGF0ZVQxPE0sIFMsIEE+LCBzOiBTKSA9PiBLaW5kPE0sIEE+XG4gIHJlYWRvbmx5IGV4ZWNTdGF0ZTogPFMsIEE+KG1hOiBTdGF0ZVQxPE0sIFMsIEE+LCBzOiBTKSA9PiBLaW5kPE0sIFM+XG59XG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRlTTI8TSBleHRlbmRzIFVSSVMyPiB7XG4gIHJlYWRvbmx5IG1hcDogPFMsIEUsIEEsIEI+KGZhOiBTdGF0ZVQyPE0sIFMsIEUsIEE+LCBmOiAoYTogQSkgPT4gQikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuICByZWFkb25seSBvZjogPFMsIEUsIEE+KGE6IEEpID0+IFN0YXRlVDI8TSwgUywgRSwgQT5cbiAgcmVhZG9ubHkgYXA6IDxTLCBFLCBBLCBCPihmYWI6IFN0YXRlVDI8TSwgUywgRSwgKGE6IEEpID0+IEI+LCBmYTogU3RhdGVUMjxNLCBTLCBFLCBBPikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuICByZWFkb25seSBjaGFpbjogPFMsIEUsIEEsIEI+KGZhOiBTdGF0ZVQyPE0sIFMsIEUsIEE+LCBmOiAoYTogQSkgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuICByZWFkb25seSBnZXQ6IDxFLCBTPigpID0+IFN0YXRlVDI8TSwgUywgRSwgUz5cbiAgcmVhZG9ubHkgcHV0OiA8RSwgUz4oczogUykgPT4gU3RhdGVUMjxNLCBTLCBFLCB2b2lkPlxuICByZWFkb25seSBtb2RpZnk6IDxFLCBTPihmOiAoczogUykgPT4gUykgPT4gU3RhdGVUMjxNLCBTLCBFLCB2b2lkPlxuICByZWFkb25seSBnZXRzOiA8UywgRSwgQT4oZjogKHM6IFMpID0+IEEpID0+IFN0YXRlVDI8TSwgUywgRSwgQT5cbiAgcmVhZG9ubHkgZnJvbVN0YXRlOiA8UywgRSwgQT4oZmE6IFN0YXRlPFMsIEE+KSA9PiBTdGF0ZVQyPE0sIFMsIEUsIEE+XG4gIHJlYWRvbmx5IGZyb21NOiA8UywgRSwgQT4obWE6IEtpbmQyPE0sIEUsIEE+KSA9PiBTdGF0ZVQyPE0sIFMsIEUsIEE+XG4gIHJlYWRvbmx5IGV2YWxTdGF0ZTogPFMsIEUsIEE+KG1hOiBTdGF0ZVQyPE0sIFMsIEUsIEE+LCBzOiBTKSA9PiBLaW5kMjxNLCBFLCBBPlxuICByZWFkb25seSBleGVjU3RhdGU6IDxTLCBFLCBBPihtYTogU3RhdGVUMjxNLCBTLCBFLCBBPiwgczogUykgPT4gS2luZDI8TSwgRSwgUz5cbn1cblxuLyoqXG4gKiBAc2luY2UgMi41LjRcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVNMkM8TSBleHRlbmRzIFVSSVMyLCBFPiB7XG4gIHJlYWRvbmx5IG1hcDogPFMsIEEsIEI+KGZhOiBTdGF0ZVQyPE0sIFMsIEUsIEE+LCBmOiAoYTogQSkgPT4gQikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuICByZWFkb25seSBvZjogPFMsIEE+KGE6IEEpID0+IFN0YXRlVDI8TSwgUywgRSwgQT5cbiAgcmVhZG9ubHkgYXA6IDxTLCBBLCBCPihmYWI6IFN0YXRlVDI8TSwgUywgRSwgKGE6IEEpID0+IEI+LCBmYTogU3RhdGVUMjxNLCBTLCBFLCBBPikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuICByZWFkb25seSBjaGFpbjogPFMsIEEsIEI+KGZhOiBTdGF0ZVQyPE0sIFMsIEUsIEE+LCBmOiAoYTogQSkgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPikgPT4gU3RhdGVUMjxNLCBTLCBFLCBCPlxuICByZWFkb25seSBnZXQ6IDxTPigpID0+IFN0YXRlVDI8TSwgUywgRSwgUz5cbiAgcmVhZG9ubHkgcHV0OiA8Uz4oczogUykgPT4gU3RhdGVUMjxNLCBTLCBFLCB2b2lkPlxuICByZWFkb25seSBtb2RpZnk6IDxTPihmOiAoczogUykgPT4gUykgPT4gU3RhdGVUMjxNLCBTLCBFLCB2b2lkPlxuICByZWFkb25seSBnZXRzOiA8UywgQT4oZjogKHM6IFMpID0+IEEpID0+IFN0YXRlVDI8TSwgUywgRSwgQT5cbiAgcmVhZG9ubHkgZnJvbVN0YXRlOiA8UywgQT4oZmE6IFN0YXRlPFMsIEE+KSA9PiBTdGF0ZVQyPE0sIFMsIEUsIEE+XG4gIHJlYWRvbmx5IGZyb21NOiA8UywgQT4obWE6IEtpbmQyPE0sIEUsIEE+KSA9PiBTdGF0ZVQyPE0sIFMsIEUsIEE+XG4gIHJlYWRvbmx5IGV2YWxTdGF0ZTogPFMsIEE+KG1hOiBTdGF0ZVQyPE0sIFMsIEUsIEE+LCBzOiBTKSA9PiBLaW5kMjxNLCBFLCBBPlxuICByZWFkb25seSBleGVjU3RhdGU6IDxTLCBBPihtYTogU3RhdGVUMjxNLCBTLCBFLCBBPiwgczogUykgPT4gS2luZDI8TSwgRSwgUz5cbn1cblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVNMzxNIGV4dGVuZHMgVVJJUzM+IHtcbiAgcmVhZG9ubHkgbWFwOiA8UywgUiwgRSwgQSwgQj4oZmE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4sIGY6IChhOiBBKSA9PiBCKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+XG4gIHJlYWRvbmx5IG9mOiA8UywgUiwgRSwgQT4oYTogQSkgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBBPlxuICByZWFkb25seSBhcDogPFMsIFIsIEUsIEEsIEI+KFxuICAgIGZhYjogU3RhdGVUMzxNLCBTLCBSLCBFLCAoYTogQSkgPT4gQj4sXG4gICAgZmE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT5cbiAgKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+XG4gIHJlYWRvbmx5IGNoYWluOiA8UywgUiwgRSwgQSwgQj4oXG4gICAgZmE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4sXG4gICAgZjogKGE6IEEpID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQj5cbiAgKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+XG4gIHJlYWRvbmx5IGdldDogPFIsIEUsIFM+KCkgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBTPlxuICByZWFkb25seSBwdXQ6IDxSLCBFLCBTPihzOiBTKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIHZvaWQ+XG4gIHJlYWRvbmx5IG1vZGlmeTogPFIsIEUsIFM+KGY6IChzOiBTKSA9PiBTKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIHZvaWQ+XG4gIHJlYWRvbmx5IGdldHM6IDxTLCBSLCBFLCBBPihmOiAoczogUykgPT4gQSkgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBBPlxuICByZWFkb25seSBmcm9tU3RhdGU6IDxTLCBSLCBFLCBBPihmYTogU3RhdGU8UywgQT4pID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQT5cbiAgcmVhZG9ubHkgZnJvbU06IDxTLCBSLCBFLCBBPihtYTogS2luZDM8TSwgUiwgRSwgQT4pID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQT5cbiAgcmVhZG9ubHkgZXZhbFN0YXRlOiA8UywgUiwgRSwgQT4obWE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4sIHM6IFMpID0+IEtpbmQzPE0sIFIsIEUsIEE+XG4gIHJlYWRvbmx5IGV4ZWNTdGF0ZTogPFMsIFIsIEUsIEE+KG1hOiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEE+LCBzOiBTKSA9PiBLaW5kMzxNLCBSLCBFLCBTPlxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjUuNFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTdGF0ZU0zQzxNIGV4dGVuZHMgVVJJUzMsIEU+IHtcbiAgcmVhZG9ubHkgbWFwOiA8UywgUiwgQSwgQj4oZmE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4sIGY6IChhOiBBKSA9PiBCKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+XG4gIHJlYWRvbmx5IG9mOiA8UywgUiwgQT4oYTogQSkgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBBPlxuICByZWFkb25seSBhcDogPFMsIFIsIEEsIEI+KGZhYjogU3RhdGVUMzxNLCBTLCBSLCBFLCAoYTogQSkgPT4gQj4sIGZhOiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEE+KSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+XG4gIHJlYWRvbmx5IGNoYWluOiA8UywgUiwgQSwgQj4oXG4gICAgZmE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4sXG4gICAgZjogKGE6IEEpID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQj5cbiAgKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEI+XG4gIHJlYWRvbmx5IGdldDogPFIsIFM+KCkgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBTPlxuICByZWFkb25seSBwdXQ6IDxSLCBTPihzOiBTKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIHZvaWQ+XG4gIHJlYWRvbmx5IG1vZGlmeTogPFIsIFM+KGY6IChzOiBTKSA9PiBTKSA9PiBTdGF0ZVQzPE0sIFMsIFIsIEUsIHZvaWQ+XG4gIHJlYWRvbmx5IGdldHM6IDxTLCBSLCBBPihmOiAoczogUykgPT4gQSkgPT4gU3RhdGVUMzxNLCBTLCBSLCBFLCBBPlxuICByZWFkb25seSBmcm9tU3RhdGU6IDxTLCBSLCBBPihmYTogU3RhdGU8UywgQT4pID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQT5cbiAgcmVhZG9ubHkgZnJvbU06IDxTLCBSLCBBPihtYTogS2luZDM8TSwgUiwgRSwgQT4pID0+IFN0YXRlVDM8TSwgUywgUiwgRSwgQT5cbiAgcmVhZG9ubHkgZXZhbFN0YXRlOiA8UywgUiwgQT4obWE6IFN0YXRlVDM8TSwgUywgUiwgRSwgQT4sIHM6IFMpID0+IEtpbmQzPE0sIFIsIEUsIEE+XG4gIHJlYWRvbmx5IGV4ZWNTdGF0ZTogPFMsIFIsIEE+KG1hOiBTdGF0ZVQzPE0sIFMsIFIsIEUsIEE+LCBzOiBTKSA9PiBLaW5kMzxNLCBSLCBFLCBTPlxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN0YXRlTTxNIGV4dGVuZHMgVVJJUzM+KE06IE1vbmFkMzxNPik6IFN0YXRlTTM8TT5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN0YXRlTTxNIGV4dGVuZHMgVVJJUzMsIEU+KE06IE1vbmFkM0M8TSwgRT4pOiBTdGF0ZU0zQzxNLCBFPlxuLyoqIEBkZXByZWNhdGVkICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhdGVNPE0gZXh0ZW5kcyBVUklTMj4oTTogTW9uYWQyPE0+KTogU3RhdGVNMjxNPlxuLyoqIEBkZXByZWNhdGVkICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhdGVNPE0gZXh0ZW5kcyBVUklTMiwgRT4oTTogTW9uYWQyQzxNLCBFPik6IFN0YXRlTTJDPE0sIEU+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdGF0ZU08TSBleHRlbmRzIFVSSVM+KE06IE1vbmFkMTxNPik6IFN0YXRlTTE8TT5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN0YXRlTTxNPihNOiBNb25hZDxNPik6IFN0YXRlTTxNPlxuLyoqIEBkZXByZWNhdGVkICovXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN0YXRlTTxNPihNOiBNb25hZDxNPik6IFN0YXRlTTxNPiB7XG4gIGNvbnN0IF9hcCA9IGFwKE0pXG4gIGNvbnN0IF9tYXAgPSBtYXAoTSlcbiAgY29uc3QgX2NoYWluID0gY2hhaW4oTSlcbiAgY29uc3QgX2V2YWx1YXRlID0gZXZhbHVhdGUoTSlcbiAgY29uc3QgX2V4ZWN1dGUgPSBleGVjdXRlKE0pXG5cbiAgcmV0dXJuIHtcbiAgICBtYXA6IChmYSwgZikgPT4gcGlwZShmYSwgX21hcChmKSksXG4gICAgYXA6IChmYWIsIGZhKSA9PiBwaXBlKGZhYiwgX2FwKGZhKSksXG4gICAgb2Y6IG9mKE0pLFxuICAgIGNoYWluOiAobWEsIGYpID0+IHBpcGUobWEsIF9jaGFpbihmKSksXG4gICAgZ2V0OiAoKSA9PiAocykgPT4gTS5vZihbcywgc10pLFxuICAgIHB1dDogKHMpID0+ICgpID0+IE0ub2YoW3VuZGVmaW5lZCwgc10pLFxuICAgIG1vZGlmeTogKGYpID0+IChzKSA9PiBNLm9mKFt1bmRlZmluZWQsIGYocyldKSxcbiAgICBnZXRzOiAoZikgPT4gKHMpID0+IE0ub2YoW2YocyksIHNdKSxcbiAgICBmcm9tU3RhdGU6IGZyb21TdGF0ZShNKSxcbiAgICBmcm9tTTogZnJvbUYoTSksXG4gICAgZXZhbFN0YXRlOiAoZmEsIHMpID0+IHBpcGUoZmEsIF9ldmFsdWF0ZShzKSksXG4gICAgZXhlY1N0YXRlOiAoZmEsIHMpID0+IHBpcGUoZmEsIF9leGVjdXRlKHMpKVxuICB9XG59XG4iXX0=