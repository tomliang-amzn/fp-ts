"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.foldM = foldM;
exports.foldMap = foldMap;
exports.getFoldableComposition = getFoldableComposition;
exports.intercalate = intercalate;
exports.reduce = reduce;
exports.reduceM = reduceM;
exports.reduceRight = reduceRight;
exports.toArray = void 0;
exports.toReadonlyArray = toReadonlyArray;
exports.traverse_ = traverse_;

var _function = require("./function");

/**
 * @since 2.0.0
 */
function reduce(F, G) {
  return function (b, f) {
    return function (fga) {
      return F.reduce(fga, b, function (b, ga) {
        return G.reduce(ga, b, f);
      });
    };
  };
}
/**
 * `foldMap` composition.
 *
 * @category combinators
 * @since 2.10.0
 */


function foldMap(F, G) {
  return function (M) {
    var foldMapF = F.foldMap(M);
    var foldMapG = G.foldMap(M);
    return function (f) {
      return function (fga) {
        return foldMapF(fga, function (ga) {
          return foldMapG(ga, f);
        });
      };
    };
  };
}
/**
 * `reduceRight` composition.
 *
 * @category combinators
 * @since 2.10.0
 */


function reduceRight(F, G) {
  return function (b, f) {
    return function (fga) {
      return F.reduceRight(fga, b, function (ga, b) {
        return G.reduceRight(ga, b, f);
      });
    };
  };
} // -------------------------------------------------------------------------------------
// utils
// -------------------------------------------------------------------------------------

/**
 * Similar to 'reduce', but the result is encapsulated in a monad.
 *
 * Note: this function is not generally stack-safe, e.g., for monads which build up thunks a la `IO`.
 *
 * @example
 * import { reduceM } from 'fp-ts/Foldable'
 * import { Monad, some } from 'fp-ts/Option'
 * import { make, Foldable } from 'fp-ts/Tree'
 * import { pipe } from 'fp-ts/function'
 *
 * const t = make(1, [make(2, []), make(3, []), make(4, [])])
 * assert.deepStrictEqual(pipe(t, reduceM(Monad, Foldable)(0, (b, a) => (a > 2 ? some(b + a) : some(b)))), some(7))
 *
 * @since 2.8.0
 */


function reduceM(M, F) {
  return function (b, f) {
    return function (fa) {
      return F.reduce(fa, M.of(b), function (mb, a) {
        return M.chain(mb, function (b) {
          return f(b, a);
        });
      });
    };
  };
} // TODO: curry in v3

/**
 * Fold a data structure, accumulating values in some `Monoid`, combining adjacent elements using the specified separator
 *
 * @example
 * import { intercalate } from 'fp-ts/Foldable'
 * import * as S from 'fp-ts/string'
 * import { make, Foldable } from 'fp-ts/Tree'
 *
 * const t = make('a', [make('b', []), make('c', []), make('d', [])])
 * assert.strictEqual(intercalate(S.Monoid, Foldable)('|', t), 'a|b|c|d')
 *
 * @since 2.0.0
 */


function intercalate(M, F) {
  return function (sep, fm) {
    var go = function go(_ref, x) {
      var init = _ref.init,
          acc = _ref.acc;
      return init ? {
        init: false,
        acc: x
      } : {
        init: false,
        acc: M.concat(M.concat(acc, sep), x)
      };
    };

    return F.reduce(fm, {
      init: true,
      acc: M.empty
    }, go).acc;
  };
}
/**
 * Transforms a `Foldable` into a `toReadonlyArray`.
 *
 * @example
 * import { toReadonlyArray } from 'fp-ts/Foldable'
 * import { Foldable, make } from 'fp-ts/Tree'
 *
 * const t = make(1, [make(2, []), make(3, []), make(4, [])])
 * assert.deepStrictEqual(toReadonlyArray(Foldable)(t), [1, 2, 3, 4])
 *
 * @since 2.10.0
 */


function toReadonlyArray(F) {
  return function (fa) {
    return F.reduce(fa, [], function (acc, a) {
      acc.push(a);
      return acc;
    });
  };
}
/**
 * Traverse a data structure, performing some effects encoded by an `Applicative` functor at each value, ignoring the
 * final result.
 *
 * @example
 * import { Foldable } from 'fp-ts/Array'
 * import { traverse_ } from 'fp-ts/Foldable'
 * import { Applicative } from 'fp-ts/IO'
 *
 * let log = ''
 * const append = (s: string) => () => (log += s)
 * traverse_(Applicative, Foldable)(['a', 'b', 'c'], append)()
 * assert.strictEqual(log, 'abc')
 *
 * @since 2.0.0
 */


function traverse_(M, F) {
  var applyFirst = function applyFirst(mu, mb) {
    return M.ap(M.map(mu, _function.constant), mb);
  };

  var mu = M.of(undefined);
  return function (fa, f) {
    return F.reduce(fa, mu, function (mu, a) {
      return applyFirst(mu, f(a));
    });
  };
} // -------------------------------------------------------------------------------------
// deprecated
// -------------------------------------------------------------------------------------
// tslint:disable: deprecation

/**
 * Use [`reduceM`](#reducem) instead
 *
 * @since 2.0.0
 * @deprecated
 */


function foldM(M, F) {
  return function (fa, b, f) {
    return F.reduce(fa, M.of(b), function (mb, a) {
      return M.chain(mb, function (b) {
        return f(b, a);
      });
    });
  };
}
/**
 * Use [`toReadonlyArray`](#toreadonlyarray) instead
 *
 * @since 2.8.0
 * @deprecated
 */


var toArray = toReadonlyArray;
/**
 * @since 2.0.0
 * @deprecated
 */

exports.toArray = toArray;

/** @deprecated */
function getFoldableComposition(F, G) {
  var _reduce = reduce(F, G);

  var _foldMap = foldMap(F, G);

  var _reduceRight = reduceRight(F, G);

  return {
    reduce: function reduce(fga, b, f) {
      return (0, _function.pipe)(fga, _reduce(b, f));
    },
    foldMap: function foldMap(M) {
      var foldMapM = _foldMap(M);

      return function (fga, f) {
        return (0, _function.pipe)(fga, foldMapM(f));
      };
    },
    reduceRight: function reduceRight(fga, b, f) {
      return (0, _function.pipe)(fga, _reduceRight(b, f));
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mcC10cy9Gb2xkYWJsZS50cyJdLCJuYW1lcyI6WyJyZWR1Y2UiLCJGIiwiRyIsImIiLCJmIiwiZmdhIiwiZ2EiLCJmb2xkTWFwIiwiTSIsImZvbGRNYXBGIiwiZm9sZE1hcEciLCJyZWR1Y2VSaWdodCIsInJlZHVjZU0iLCJmYSIsIm9mIiwibWIiLCJhIiwiY2hhaW4iLCJpbnRlcmNhbGF0ZSIsInNlcCIsImZtIiwiZ28iLCJ4IiwiaW5pdCIsImFjYyIsImNvbmNhdCIsImVtcHR5IiwidG9SZWFkb25seUFycmF5IiwicHVzaCIsInRyYXZlcnNlXyIsImFwcGx5Rmlyc3QiLCJtdSIsImFwIiwibWFwIiwiY29uc3RhbnQiLCJ1bmRlZmluZWQiLCJmb2xkTSIsInRvQXJyYXkiLCJnZXRGb2xkYWJsZUNvbXBvc2l0aW9uIiwiX3JlZHVjZSIsIl9mb2xkTWFwIiwiX3JlZHVjZVJpZ2h0IiwiZm9sZE1hcE0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFJQTs7QUFKQTtBQUNBO0FBQ0E7QUE0R08sU0FBU0EsTUFBVCxDQUNMQyxDQURLLEVBRUxDLENBRkssRUFHZ0U7QUFDckUsU0FBTyxVQUFDQyxDQUFELEVBQUlDLENBQUo7QUFBQSxXQUFVLFVBQUNDLEdBQUQ7QUFBQSxhQUFTSixDQUFDLENBQUNELE1BQUYsQ0FBU0ssR0FBVCxFQUFjRixDQUFkLEVBQWlCLFVBQUNBLENBQUQsRUFBSUcsRUFBSjtBQUFBLGVBQVdKLENBQUMsQ0FBQ0YsTUFBRixDQUFTTSxFQUFULEVBQWFILENBQWIsRUFBZ0JDLENBQWhCLENBQVg7QUFBQSxPQUFqQixDQUFUO0FBQUEsS0FBVjtBQUFBLEdBQVA7QUFDRDtBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBU08sU0FBU0csT0FBVCxDQUNMTixDQURLLEVBRUxDLENBRkssRUFHc0U7QUFDM0UsU0FBTyxVQUFDTSxDQUFELEVBQU87QUFDWixRQUFNQyxRQUFRLEdBQUdSLENBQUMsQ0FBQ00s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TUxPLElBQUFBLFdBQVcsRUFBRSxxQkFBQ04sR0FBRCxFQUFNRixDQUFOLEVBQVNDLENBQVQ7QUFBQSxhQUFlLG9CQUFLQyxHQUFMLEVBQVVvQyxZQUFZLENBQUN0QyxDQUFELEVBQUlDLENBQUosQ0FBdEIsQ0FBZjtBQUFBO0FBTlIsR0FBUDtBQVFEIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuaW1wb3J0IHsgQXBwbGljYXRpdmUsIEFwcGxpY2F0aXZlMSwgQXBwbGljYXRpdmUyLCBBcHBsaWNhdGl2ZTJDLCBBcHBsaWNhdGl2ZTMgfSBmcm9tICcuL0FwcGxpY2F0aXZlJ1xuaW1wb3J0IHsgY29uc3RhbnQsIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJ1xuaW1wb3J0IHsgSEtULCBLaW5kLCBLaW5kMiwgS2luZDMsIFVSSVMsIFVSSVMyLCBVUklTMywgVVJJUzQsIEtpbmQ0IH0gZnJvbSAnLi9IS1QnXG5pbXBvcnQgeyBNb25hZCwgTW9uYWQxLCBNb25hZDIsIE1vbmFkMkMsIE1vbmFkMywgTW9uYWQzQyB9IGZyb20gJy4vTW9uYWQnXG5pbXBvcnQgeyBNb25vaWQgfSBmcm9tICcuL01vbm9pZCdcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbW9kZWxcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBjbGFzc2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb2xkYWJsZTxGPiB7XG4gIHJlYWRvbmx5IFVSSTogRlxuICByZWFkb25seSByZWR1Y2U6IDxBLCBCPihmYTogSEtUPEYsIEE+LCBiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gQikgPT4gQlxuICByZWFkb25seSBmb2xkTWFwOiA8TT4oTTogTW9ub2lkPE0+KSA9PiA8QT4oZmE6IEhLVDxGLCBBPiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxBLCBCPihmYTogSEtUPEYsIEE+LCBiOiBCLCBmOiAoYTogQSwgYjogQikgPT4gQikgPT4gQlxufVxuXG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGNsYXNzZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlMTxGIGV4dGVuZHMgVVJJUz4ge1xuICByZWFkb25seSBVUkk6IEZcbiAgcmVhZG9ubHkgcmVkdWNlOiA8QSwgQj4oZmE6IEtpbmQ8RiwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiBCXG4gIHJlYWRvbmx5IGZvbGRNYXA6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxBPihmYTogS2luZDxGLCBBPiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxBLCBCPihmYTogS2luZDxGLCBBPiwgYjogQiwgZjogKGE6IEEsIGI6IEIpID0+IEIpID0+IEJcbn1cblxuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBjbGFzc2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb2xkYWJsZTI8RiBleHRlbmRzIFVSSVMyPiB7XG4gIHJlYWRvbmx5IFVSSTogRlxuICByZWFkb25seSByZWR1Y2U6IDxFLCBBLCBCPihmYTogS2luZDI8RiwgRSwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiBCXG4gIHJlYWRvbmx5IGZvbGRNYXA6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxFLCBBPihmYTogS2luZDI8RiwgRSwgQT4sIGY6IChhOiBBKSA9PiBNKSA9PiBNXG4gIHJlYWRvbmx5IHJlZHVjZVJpZ2h0OiA8RSwgQSwgQj4oZmE6IEtpbmQyPEYsIEUsIEE+LCBiOiBCLCBmOiAoYTogQSwgYjogQikgPT4gQikgPT4gQlxufVxuXG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGNsYXNzZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlMkM8RiBleHRlbmRzIFVSSVMyLCBFPiB7XG4gIHJlYWRvbmx5IFVSSTogRlxuICByZWFkb25seSBfRTogRVxuICByZWFkb25seSByZWR1Y2U6IDxBLCBCPihmYTogS2luZDI8RiwgRSwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiBCXG4gIHJlYWRvbmx5IGZvbGRNYXA6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxBPihmYTogS2luZDI8RiwgRSwgQT4sIGY6IChhOiBBKSA9PiBNKSA9PiBNXG4gIHJlYWRvbmx5IHJlZHVjZVJpZ2h0OiA8QSwgQj4oZmE6IEtpbmQyPEYsIEUsIEE+LCBiOiBCLCBmOiAoYTogQSwgYjogQikgPT4gQikgPT4gQlxufVxuXG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGNsYXNzZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlMzxGIGV4dGVuZHMgVVJJUzM+IHtcbiAgcmVhZG9ubHkgVVJJOiBGXG4gIHJlYWRvbmx5IHJlZHVjZTogPFIsIEUsIEEsIEI+KGZhOiBLaW5kMzxGLCBSLCBFLCBBPiwgYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEIpID0+IEJcbiAgcmVhZG9ubHkgZm9sZE1hcDogPE0+KE06IE1vbm9pZDxNPikgPT4gPFIsIEUsIEE+KGZhOiBLaW5kMzxGLCBSLCBFLCBBPiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxSLCBFLCBBLCBCPihmYTogS2luZDM8RiwgUiwgRSwgQT4sIGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiBCXG59XG5cbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgY2xhc3Nlc1xuICogQHNpbmNlIDIuMi4wXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRm9sZGFibGUzQzxGIGV4dGVuZHMgVVJJUzMsIEU+IHtcbiAgcmVhZG9ubHkgVVJJOiBGXG4gIHJlYWRvbmx5IF9FOiBFXG4gIHJlYWRvbmx5IHJlZHVjZTogPFIsIEEsIEI+KGZhOiBLaW5kMzxGLCBSLCBFLCBBPiwgYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEIpID0+IEJcbiAgcmVhZG9ubHkgZm9sZE1hcDogPE0+KE06IE1vbm9pZDxNPikgPT4gPFIsIEE+KGZhOiBLaW5kMzxGLCBSLCBFLCBBPiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxSLCBBLCBCPihmYTogS2luZDM8RiwgUiwgRSwgQT4sIGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiBCXG59XG5cbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgY2xhc3Nlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRm9sZGFibGU0PEYgZXh0ZW5kcyBVUklTND4ge1xuICByZWFkb25seSBVUkk6IEZcbiAgcmVhZG9ubHkgcmVkdWNlOiA8UywgUiwgRSwgQSwgQj4oZmE6IEtpbmQ0PEYsIFMsIFIsIEUsIEE+LCBiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gQikgPT4gQlxuICByZWFkb25seSBmb2xkTWFwOiA8TT4oTTogTW9ub2lkPE0+KSA9PiA8UywgUiwgRSwgQT4oZmE6IEtpbmQ0PEYsIFMsIFIsIEUsIEE+LCBmOiAoYTogQSkgPT4gTSkgPT4gTVxuICByZWFkb25seSByZWR1Y2VSaWdodDogPFMsIFIsIEUsIEEsIEI+KGZhOiBLaW5kNDxGLCBTLCBSLCBFLCBBPiwgYjogQiwgZjogKGE6IEEsIGI6IEIpID0+IEIpID0+IEJcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiBgcmVkdWNlYCBjb21wb3NpdGlvbi5cbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZHVjZTxGIGV4dGVuZHMgVVJJUywgRyBleHRlbmRzIFVSSVM+KFxuICBGOiBGb2xkYWJsZTE8Rj4sXG4gIEc6IEZvbGRhYmxlMTxHPlxuKTogPEIsIEE+KGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiAoZmdhOiBLaW5kPEYsIEtpbmQ8RywgQT4+KSA9PiBCXG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlPEYsIEc+KFxuICBGOiBGb2xkYWJsZTxGPixcbiAgRzogRm9sZGFibGU8Rz5cbik6IDxCLCBBPihiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gQikgPT4gKGZnYTogSEtUPEYsIEhLVDxHLCBBPj4pID0+IEJcbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2U8RiwgRz4oXG4gIEY6IEZvbGRhYmxlPEY+LFxuICBHOiBGb2xkYWJsZTxHPlxuKTogPEIsIEE+KGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiAoZmdhOiBIS1Q8RiwgSEtUPEcsIEE+PikgPT4gQiB7XG4gIHJldHVybiAoYiwgZikgPT4gKGZnYSkgPT4gRi5yZWR1Y2UoZmdhLCBiLCAoYiwgZ2EpID0+IEcucmVkdWNlKGdhLCBiLCBmKSlcbn1cblxuLyoqXG4gKiBgZm9sZE1hcGAgY29tcG9zaXRpb24uXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb2xkTWFwPEYgZXh0ZW5kcyBVUklTLCBHIGV4dGVuZHMgVVJJUz4oXG4gIEY6IEZvbGRhYmxlMTxGPixcbiAgRzogRm9sZGFibGUxPEc+XG4pOiA8TT4oTTogTW9ub2lkPE0+KSA9PiA8QT4oZjogKGE6IEEpID0+IE0pID0+IChmZ2E6IEtpbmQ8RiwgS2luZDxHLCBBPj4pID0+IE1cbmV4cG9ydCBmdW5jdGlvbiBmb2xkTWFwPEYsIEc+KFxuICBGOiBGb2xkYWJsZTxGPixcbiAgRzogRm9sZGFibGU8Rz5cbik6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxBPihmOiAoYTogQSkgPT4gTSkgPT4gKGZnYTogSEtUPEYsIEhLVDxHLCBBPj4pID0+IE1cbmV4cG9ydCBmdW5jdGlvbiBmb2xkTWFwPEYsIEc+KFxuICBGOiBGb2xkYWJsZTxGPixcbiAgRzogRm9sZGFibGU8Rz5cbik6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxBPihmOiAoYTogQSkgPT4gTSkgPT4gKGZnYTogSEtUPEYsIEhLVDxHLCBBPj4pID0+IE0ge1xuICByZXR1cm4gKE0pID0+IHtcbiAgICBjb25zdCBmb2xkTWFwRiA9IEYuZm9sZE1hcChNKVxuICAgIGNvbnN0IGZvbGRNYXBHID0gRy5mb2xkTWFwKE0pXG4gICAgcmV0dXJuIChmKSA9PiAoZmdhKSA9PiBmb2xkTWFwRihmZ2EsIChnYSkgPT4gZm9sZE1hcEcoZ2EsIGYpKVxuICB9XG59XG5cbi8qKlxuICogYHJlZHVjZVJpZ2h0YCBjb21wb3NpdGlvbi5cbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZHVjZVJpZ2h0PEYgZXh0ZW5kcyBVUklTLCBHIGV4dGVuZHMgVVJJUz4oXG4gIEY6IEZvbGRhYmxlMTxGPixcbiAgRzogRm9sZGFibGUxPEc+XG4pOiA8QiwgQT4oYjogQiwgZjogKGE6IEEsIGI6IEIpID0+IEIpID0+IChmZ2E6IEtpbmQ8RiwgS2luZDxHLCBBPj4pID0+IEJcbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2VSaWdodDxGLCBHPihcbiAgRjogRm9sZGFibGU8Rj4sXG4gIEc6IEZvbGRhYmxlPEc+XG4pOiA8QiwgQT4oYjogQiwgZjogKGE6IEEsIGI6IEIpID0+IEIpID0+IChmZ2E6IEhLVDxGLCBIS1Q8RywgQT4+KSA9PiBCXG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlUmlnaHQ8RiwgRz4oXG4gIEY6IEZvbGRhYmxlPEY+LFxuICBHOiBGb2xkYWJsZTxHPlxuKTogPEIsIEE+KGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiAoZmdhOiBIS1Q8RiwgSEtUPEcsIEE+PikgPT4gQiB7XG4gIHJldHVybiAoYiwgZikgPT4gKGZnYSkgPT4gRi5yZWR1Y2VSaWdodChmZ2EsIGIsIChnYSwgYikgPT4gRy5yZWR1Y2VSaWdodChnYSwgYiwgZikpXG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogU2ltaWxhciB0byAncmVkdWNlJywgYnV0IHRoZSByZXN1bHQgaXMgZW5jYXBzdWxhdGVkIGluIGEgbW9uYWQuXG4gKlxuICogTm90ZTogdGhpcyBmdW5jdGlvbiBpcyBub3QgZ2VuZXJhbGx5IHN0YWNrLXNhZmUsIGUuZy4sIGZvciBtb25hZHMgd2hpY2ggYnVpbGQgdXAgdGh1bmtzIGEgbGEgYElPYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVkdWNlTSB9IGZyb20gJ2ZwLXRzL0ZvbGRhYmxlJ1xuICogaW1wb3J0IHsgTW9uYWQsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBtYWtlLCBGb2xkYWJsZSB9IGZyb20gJ2ZwLXRzL1RyZWUnXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgdCA9IG1ha2UoMSwgW21ha2UoMiwgW10pLCBtYWtlKDMsIFtdKSwgbWFrZSg0LCBbXSldKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKHQsIHJlZHVjZU0oTW9uYWQsIEZvbGRhYmxlKSgwLCAoYiwgYSkgPT4gKGEgPiAyID8gc29tZShiICsgYSkgOiBzb21lKGIpKSkpLCBzb21lKDcpKVxuICpcbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlTTxNIGV4dGVuZHMgVVJJUzMsIEYgZXh0ZW5kcyBVUklTPihcbiAgTTogTW9uYWQzPE0+LFxuICBGOiBGb2xkYWJsZTE8Rj5cbik6IDxCLCBBLCBSLCBFPihiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gS2luZDM8TSwgUiwgRSwgQj4pID0+IChmYTogS2luZDxGLCBBPikgPT4gS2luZDM8TSwgUiwgRSwgQj5cbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2VNPE0gZXh0ZW5kcyBVUklTMywgRiBleHRlbmRzIFVSSVMsIEU+KFxuICBNOiBNb25hZDNDPE0sIEU+LFxuICBGOiBGb2xkYWJsZTE8Rj5cbik6IDxCLCBBLCBSPihiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gS2luZDM8TSwgUiwgRSwgQj4pID0+IChmYTogS2luZDxGLCBBPikgPT4gS2luZDM8TSwgUiwgRSwgQj5cbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2VNPE0gZXh0ZW5kcyBVUklTMiwgRiBleHRlbmRzIFVSSVM+KFxuICBNOiBNb25hZDI8TT4sXG4gIEY6IEZvbGRhYmxlMTxGPlxuKTogPEIsIEEsIEU+KGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBLaW5kMjxNLCBFLCBCPikgPT4gKGZhOiBLaW5kPEYsIEE+KSA9PiBLaW5kMjxNLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIHJlZHVjZU08TSBleHRlbmRzIFVSSVMyLCBGIGV4dGVuZHMgVVJJUywgRT4oXG4gIE06IE1vbmFkMkM8TSwgRT4sXG4gIEY6IEZvbGRhYmxlMTxGPlxuKTogPEIsIEE+KGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBLaW5kMjxNLCBFLCBCPikgPT4gKGZhOiBLaW5kPEYsIEE+KSA9PiBLaW5kMjxNLCBFLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIHJlZHVjZU08TSBleHRlbmRzIFVSSVMsIEYgZXh0ZW5kcyBVUklTPihcbiAgTTogTW9uYWQxPE0+LFxuICBGOiBGb2xkYWJsZTE8Rj5cbik6IDxCLCBBPihiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gS2luZDxNLCBCPikgPT4gKGZhOiBLaW5kPEYsIEE+KSA9PiBLaW5kPE0sIEI+XG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlTTxNLCBGPihcbiAgTTogTW9uYWQ8TT4sXG4gIEY6IEZvbGRhYmxlPEY+XG4pOiA8QiwgQT4oYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEhLVDxNLCBCPikgPT4gKGZhOiBIS1Q8RiwgQT4pID0+IEhLVDxNLCBCPlxuZXhwb3J0IGZ1bmN0aW9uIHJlZHVjZU08TSwgRj4oXG4gIE06IE1vbmFkPE0+LFxuICBGOiBGb2xkYWJsZTxGPlxuKTogPEIsIEE+KGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBIS1Q8TSwgQj4pID0+IChmYTogSEtUPEYsIEE+KSA9PiBIS1Q8TSwgQj4ge1xuICByZXR1cm4gKGIsIGYpID0+IChmYSkgPT4gRi5yZWR1Y2UoZmEsIE0ub2YoYiksIChtYiwgYSkgPT4gTS5jaGFpbihtYiwgKGIpID0+IGYoYiwgYSkpKVxufVxuXG4vLyBUT0RPOiBjdXJyeSBpbiB2M1xuLyoqXG4gKiBGb2xkIGEgZGF0YSBzdHJ1Y3R1cmUsIGFjY3VtdWxhdGluZyB2YWx1ZXMgaW4gc29tZSBgTW9ub2lkYCwgY29tYmluaW5nIGFkamFjZW50IGVsZW1lbnRzIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2VwYXJhdG9yXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvRm9sZGFibGUnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IG1ha2UsIEZvbGRhYmxlIH0gZnJvbSAnZnAtdHMvVHJlZSdcbiAqXG4gKiBjb25zdCB0ID0gbWFrZSgnYScsIFttYWtlKCdiJywgW10pLCBtYWtlKCdjJywgW10pLCBtYWtlKCdkJywgW10pXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCwgRm9sZGFibGUpKCd8JywgdCksICdhfGJ8Y3xkJylcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVyY2FsYXRlPE0sIEYgZXh0ZW5kcyBVUklTMz4oXG4gIE06IE1vbm9pZDxNPixcbiAgRjogRm9sZGFibGUzPEY+XG4pOiA8UiwgRT4oc2VwOiBNLCBmbTogS2luZDM8RiwgUiwgRSwgTT4pID0+IE1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcmNhbGF0ZTxNLCBGIGV4dGVuZHMgVVJJUzI+KE06IE1vbm9pZDxNPiwgRjogRm9sZGFibGUyPEY+KTogPEU+KHNlcDogTSwgZm06IEtpbmQyPEYsIEUsIE0+KSA9PiBNXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJjYWxhdGU8TSwgRiBleHRlbmRzIFVSSVMyLCBFPihNOiBNb25vaWQ8TT4sIEY6IEZvbGRhYmxlMkM8RiwgRT4pOiAoc2VwOiBNLCBmbTogS2luZDI8RiwgRSwgTT4pID0+IE1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcmNhbGF0ZTxNLCBGIGV4dGVuZHMgVVJJUz4oTTogTW9ub2lkPE0+LCBGOiBGb2xkYWJsZTE8Rj4pOiAoc2VwOiBNLCBmbTogS2luZDxGLCBNPikgPT4gTVxuZXhwb3J0IGZ1bmN0aW9uIGludGVyY2FsYXRlPE0sIEY+KE06IE1vbm9pZDxNPiwgRjogRm9sZGFibGU8Rj4pOiAoc2VwOiBNLCBmbTogSEtUPEYsIE0+KSA9PiBNXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJjYWxhdGU8TSwgRj4oTTogTW9ub2lkPE0+LCBGOiBGb2xkYWJsZTxGPik6IChzZXA6IE0sIGZtOiBIS1Q8RiwgTT4pID0+IE0ge1xuICBpbnRlcmZhY2UgQWNjPE0+IHtcbiAgICByZWFkb25seSBpbml0OiBib29sZWFuXG4gICAgcmVhZG9ubHkgYWNjOiBNXG4gIH1cbiAgcmV0dXJuIChzZXAsIGZtKSA9PiB7XG4gICAgY29uc3QgZ28gPSAoeyBpbml0LCBhY2MgfTogQWNjPE0+LCB4OiBNKTogQWNjPE0+ID0+XG4gICAgICBpbml0ID8geyBpbml0OiBmYWxzZSwgYWNjOiB4IH0gOiB7IGluaXQ6IGZhbHNlLCBhY2M6IE0uY29uY2F0KE0uY29uY2F0KGFjYywgc2VwKSwgeCkgfVxuICAgIHJldHVybiBGLnJlZHVjZShmbSwgeyBpbml0OiB0cnVlLCBhY2M6IE0uZW1wdHkgfSwgZ28pLmFjY1xuICB9XG59XG5cbi8qKlxuICogVHJhbnNmb3JtcyBhIGBGb2xkYWJsZWAgaW50byBhIGB0b1JlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0b1JlYWRvbmx5QXJyYXkgfSBmcm9tICdmcC10cy9Gb2xkYWJsZSdcbiAqIGltcG9ydCB7IEZvbGRhYmxlLCBtYWtlIH0gZnJvbSAnZnAtdHMvVHJlZSdcbiAqXG4gKiBjb25zdCB0ID0gbWFrZSgxLCBbbWFrZSgyLCBbXSksIG1ha2UoMywgW10pLCBtYWtlKDQsIFtdKV0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRvUmVhZG9ubHlBcnJheShGb2xkYWJsZSkodCksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b1JlYWRvbmx5QXJyYXk8RiBleHRlbmRzIFVSSVM0PihcbiAgRjogRm9sZGFibGU0PEY+XG4pOiA8UywgUiwgRSwgQT4oZmE6IEtpbmQ0PEYsIFMsIFIsIEUsIEE+KSA9PiBSZWFkb25seUFycmF5PEE+XG5leHBvcnQgZnVuY3Rpb24gdG9SZWFkb25seUFycmF5PEYgZXh0ZW5kcyBVUklTMz4oRjogRm9sZGFibGUzPEY+KTogPFIsIEUsIEE+KGZhOiBLaW5kMzxGLCBSLCBFLCBBPikgPT4gUmVhZG9ubHlBcnJheTxBPlxuZXhwb3J0IGZ1bmN0aW9uIHRvUmVhZG9ubHlBcnJheTxGIGV4dGVuZHMgVVJJUzMsIEU+KFxuICBGOiBGb2xkYWJsZTNDPEYsIEU+XG4pOiA8UiwgQT4oZmE6IEtpbmQzPEYsIFIsIEUsIEE+KSA9PiBSZWFkb25seUFycmF5PEE+XG5leHBvcnQgZnVuY3Rpb24gdG9SZWFkb25seUFycmF5PEYgZXh0ZW5kcyBVUklTMj4oRjogRm9sZGFibGUyPEY+KTogPEUsIEE+KGZhOiBLaW5kMjxGLCBFLCBBPikgPT4gUmVhZG9ubHlBcnJheTxBPlxuZXhwb3J0IGZ1bmN0aW9uIHRvUmVhZG9ubHlBcnJheTxGIGV4dGVuZHMgVVJJUzIsIEU+KEY6IEZvbGRhYmxlMkM8RiwgRT4pOiA8QT4oZmE6IEtpbmQyPEYsIEUsIEE+KSA9PiBSZWFkb25seUFycmF5PEE+XG5leHBvcnQgZnVuY3Rpb24gdG9SZWFkb25seUFycmF5PEYgZXh0ZW5kcyBVUklTPihGOiBGb2xkYWJsZTE8Rj4pOiA8QT4oZmE6IEtpbmQ8RiwgQT4pID0+IFJlYWRvbmx5QXJyYXk8QT5cbmV4cG9ydCBmdW5jdGlvbiB0b1JlYWRvbmx5QXJyYXk8Rj4oRjogRm9sZGFibGU8Rj4pOiA8QT4oZmE6IEhLVDxGLCBBPikgPT4gUmVhZG9ubHlBcnJheTxBPlxuZXhwb3J0IGZ1bmN0aW9uIHRvUmVhZG9ubHlBcnJheTxGPihGOiBGb2xkYWJsZTxGPik6IDxBPihmYTogSEtUPEYsIEE+KSA9PiBSZWFkb25seUFycmF5PEE+IHtcbiAgcmV0dXJuIDxBPihmYTogSEtUPEYsIEE+KSA9PlxuICAgIEYucmVkdWNlKGZhLCBbXSwgKGFjYzogQXJyYXk8QT4sIGEpID0+IHtcbiAgICAgIGFjYy5wdXNoKGEpXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSlcbn1cblxuLyoqXG4gKiBUcmF2ZXJzZSBhIGRhdGEgc3RydWN0dXJlLCBwZXJmb3JtaW5nIHNvbWUgZWZmZWN0cyBlbmNvZGVkIGJ5IGFuIGBBcHBsaWNhdGl2ZWAgZnVuY3RvciBhdCBlYWNoIHZhbHVlLCBpZ25vcmluZyB0aGVcbiAqIGZpbmFsIHJlc3VsdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRm9sZGFibGUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHRyYXZlcnNlXyB9IGZyb20gJ2ZwLXRzL0ZvbGRhYmxlJ1xuICogaW1wb3J0IHsgQXBwbGljYXRpdmUgfSBmcm9tICdmcC10cy9JTydcbiAqXG4gKiBsZXQgbG9nID0gJydcbiAqIGNvbnN0IGFwcGVuZCA9IChzOiBzdHJpbmcpID0+ICgpID0+IChsb2cgKz0gcylcbiAqIHRyYXZlcnNlXyhBcHBsaWNhdGl2ZSwgRm9sZGFibGUpKFsnYScsICdiJywgJ2MnXSwgYXBwZW5kKSgpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobG9nLCAnYWJjJylcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYXZlcnNlXzxNIGV4dGVuZHMgVVJJUzMsIEYgZXh0ZW5kcyBVUklTPihcbiAgTTogQXBwbGljYXRpdmUzPE0+LFxuICBGOiBGb2xkYWJsZTE8Rj5cbik6IDxSLCBFLCBBLCBCPihmYTogS2luZDxGLCBBPiwgZjogKGE6IEEpID0+IEtpbmQzPE0sIFIsIEUsIEI+KSA9PiBLaW5kMzxNLCBSLCBFLCB2b2lkPlxuZXhwb3J0IGZ1bmN0aW9uIHRyYXZlcnNlXzxNIGV4dGVuZHMgVVJJUzIsIEYgZXh0ZW5kcyBVUklTPihcbiAgTTogQXBwbGljYXRpdmUyPE0+LFxuICBGOiBGb2xkYWJsZTE8Rj5cbik6IDxFLCBBLCBCPihmYTogS2luZDxGLCBBPiwgZjogKGE6IEEpID0+IEtpbmQyPE0sIEUsIEI+KSA9PiBLaW5kMjxNLCBFLCB2b2lkPlxuZXhwb3J0IGZ1bmN0aW9uIHRyYXZlcnNlXzxNIGV4dGVuZHMgVVJJUzIsIEYgZXh0ZW5kcyBVUklTLCBFPihcbiAgTTogQXBwbGljYXRpdmUyQzxNLCBFPixcbiAgRjogRm9sZGFibGUxPEY+XG4pOiA8QSwgQj4oZmE6IEtpbmQ8RiwgQT4sIGY6IChhOiBBKSA9PiBLaW5kMjxNLCBFLCBCPikgPT4gS2luZDI8TSwgRSwgdm9pZD5cbmV4cG9ydCBmdW5jdGlvbiB0cmF2ZXJzZV88TSBleHRlbmRzIFVSSVMsIEYgZXh0ZW5kcyBVUklTPihcbiAgTTogQXBwbGljYXRpdmUxPE0+LFxuICBGOiBGb2xkYWJsZTE8Rj5cbik6IDxBLCBCPihmYTogS2luZDxGLCBBPiwgZjogKGE6IEEpID0+IEtpbmQ8TSwgQj4pID0+IEtpbmQ8TSwgdm9pZD5cbmV4cG9ydCBmdW5jdGlvbiB0cmF2ZXJzZV88TSwgRj4oXG4gIE06IEFwcGxpY2F0aXZlPE0+LFxuICBGOiBGb2xkYWJsZTxGPlxuKTogPEEsIEI+KGZhOiBIS1Q8RiwgQT4sIGY6IChhOiBBKSA9PiBIS1Q8TSwgQj4pID0+IEhLVDxNLCB2b2lkPlxuZXhwb3J0IGZ1bmN0aW9uIHRyYXZlcnNlXzxNLCBGPihcbiAgTTogQXBwbGljYXRpdmU8TT4sXG4gIEY6IEZvbGRhYmxlPEY+XG4pOiA8QSwgQj4oZmE6IEhLVDxGLCBBPiwgZjogKGE6IEEpID0+IEhLVDxNLCBCPikgPT4gSEtUPE0sIHZvaWQ+IHtcbiAgY29uc3QgYXBwbHlGaXJzdCA9IDxCPihtdTogSEtUPE0sIHZvaWQ+LCBtYjogSEtUPE0sIEI+KTogSEtUPE0sIHZvaWQ+ID0+IE0uYXAoTS5tYXAobXUsIGNvbnN0YW50KSwgbWIpXG4gIGNvbnN0IG11OiBIS1Q8TSwgdm9pZD4gPSBNLm9mKHVuZGVmaW5lZClcbiAgcmV0dXJuIChmYSwgZikgPT4gRi5yZWR1Y2UoZmEsIG11LCAobXUsIGEpID0+IGFwcGx5Rmlyc3QobXUsIGYoYSkpKVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIHRzbGludDpkaXNhYmxlOiBkZXByZWNhdGlvblxuXG4vKipcbiAqIFVzZSBbYHJlZHVjZU1gXSgjcmVkdWNlbSkgaW5zdGVhZFxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGRNPE0gZXh0ZW5kcyBVUklTMywgRiBleHRlbmRzIFVSSVM+KFxuICBNOiBNb25hZDM8TT4sXG4gIEY6IEZvbGRhYmxlMTxGPlxuKTogPFIsIEUsIEEsIEI+KGZhOiBLaW5kPEYsIEE+LCBiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gS2luZDM8TSwgUiwgRSwgQj4pID0+IEtpbmQzPE0sIFIsIEUsIEI+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBmb2xkTTxNIGV4dGVuZHMgVVJJUzMsIEYgZXh0ZW5kcyBVUklTLCBFPihcbiAgTTogTW9uYWQzQzxNLCBFPixcbiAgRjogRm9sZGFibGUxPEY+XG4pOiA8UiwgQSwgQj4oZmE6IEtpbmQ8RiwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBLaW5kMzxNLCBSLCBFLCBCPikgPT4gS2luZDM8TSwgUiwgRSwgQj5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGRNPE0gZXh0ZW5kcyBVUklTMiwgRiBleHRlbmRzIFVSSVM+KFxuICBNOiBNb25hZDI8TT4sXG4gIEY6IEZvbGRhYmxlMTxGPlxuKTogPEUsIEEsIEI+KGZhOiBLaW5kPEYsIEE+LCBiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gS2luZDI8TSwgRSwgQj4pID0+IEtpbmQyPE0sIEUsIEI+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBmb2xkTTxNIGV4dGVuZHMgVVJJUzIsIEYgZXh0ZW5kcyBVUklTLCBFPihcbiAgTTogTW9uYWQyQzxNLCBFPixcbiAgRjogRm9sZGFibGUxPEY+XG4pOiA8QSwgQj4oZmE6IEtpbmQ8RiwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBLaW5kMjxNLCBFLCBCPikgPT4gS2luZDI8TSwgRSwgQj5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGRNPE0gZXh0ZW5kcyBVUklTLCBGIGV4dGVuZHMgVVJJUz4oXG4gIE06IE1vbmFkMTxNPixcbiAgRjogRm9sZGFibGUxPEY+XG4pOiA8QSwgQj4oZmE6IEtpbmQ8RiwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBLaW5kPE0sIEI+KSA9PiBLaW5kPE0sIEI+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBmb2xkTTxNLCBGPihcbiAgTTogTW9uYWQ8TT4sXG4gIEY6IEZvbGRhYmxlPEY+XG4pOiA8QSwgQj4oZmE6IEhLVDxGLCBBPiwgYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEhLVDxNLCBCPikgPT4gSEtUPE0sIEI+XG5leHBvcnQgZnVuY3Rpb24gZm9sZE08TSwgRj4oXG4gIE06IE1vbmFkPE0+LFxuICBGOiBGb2xkYWJsZTxGPlxuKTogPEEsIEI+KGZhOiBIS1Q8RiwgQT4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBIS1Q8TSwgQj4pID0+IEhLVDxNLCBCPiB7XG4gIHJldHVybiAoZmEsIGIsIGYpID0+IEYucmVkdWNlKGZhLCBNLm9mKGIpLCAobWIsIGEpID0+IE0uY2hhaW4obWIsIChiKSA9PiBmKGIsIGEpKSlcbn1cblxuLyoqXG4gKiBVc2UgW2B0b1JlYWRvbmx5QXJyYXlgXSgjdG9yZWFkb25seWFycmF5KSBpbnN0ZWFkXG4gKlxuICogQHNpbmNlIDIuOC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgY29uc3QgdG9BcnJheSA9IHRvUmVhZG9ubHlBcnJheVxuXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb2xkYWJsZUNvbXBvc2l0aW9uPEYsIEc+IHtcbiAgcmVhZG9ubHkgcmVkdWNlOiA8QSwgQj4oZmdhOiBIS1Q8RiwgSEtUPEcsIEE+PiwgYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEIpID0+IEJcbiAgcmVhZG9ubHkgZm9sZE1hcDogPE0+KE06IE1vbm9pZDxNPikgPT4gPEE+KGZhOiBIS1Q8RiwgSEtUPEcsIEE+PiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxBLCBCPihmYTogSEtUPEYsIEhLVDxHLCBBPj4sIGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiBCXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlQ29tcG9zaXRpb24xMTxGIGV4dGVuZHMgVVJJUywgRyBleHRlbmRzIFVSSVM+IHtcbiAgcmVhZG9ubHkgcmVkdWNlOiA8QSwgQj4oZmdhOiBLaW5kPEYsIEtpbmQ8RywgQT4+LCBiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gQikgPT4gQlxuICByZWFkb25seSBmb2xkTWFwOiA8TT4oTTogTW9ub2lkPE0+KSA9PiA8QT4oZmE6IEtpbmQ8RiwgS2luZDxHLCBBPj4sIGY6IChhOiBBKSA9PiBNKSA9PiBNXG4gIHJlYWRvbmx5IHJlZHVjZVJpZ2h0OiA8QSwgQj4oZmE6IEtpbmQ8RiwgS2luZDxHLCBBPj4sIGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiBCXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlQ29tcG9zaXRpb24xMjxGIGV4dGVuZHMgVVJJUywgRyBleHRlbmRzIFVSSVMyPiB7XG4gIHJlYWRvbmx5IHJlZHVjZTogPEUsIEEsIEI+KGZnYTogS2luZDxGLCBLaW5kMjxHLCBFLCBBPj4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiBCXG4gIHJlYWRvbmx5IGZvbGRNYXA6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxFLCBBPihmYTogS2luZDxGLCBLaW5kMjxHLCBFLCBBPj4sIGY6IChhOiBBKSA9PiBNKSA9PiBNXG4gIHJlYWRvbmx5IHJlZHVjZVJpZ2h0OiA8RSwgQSwgQj4oZmE6IEtpbmQ8RiwgS2luZDI8RywgRSwgQT4+LCBiOiBCLCBmOiAoYTogQSwgYjogQikgPT4gQikgPT4gQlxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb2xkYWJsZUNvbXBvc2l0aW9uMTJDPEYgZXh0ZW5kcyBVUklTLCBHIGV4dGVuZHMgVVJJUzIsIEU+IHtcbiAgcmVhZG9ubHkgcmVkdWNlOiA8QSwgQj4oZmdhOiBLaW5kPEYsIEtpbmQyPEcsIEUsIEE+PiwgYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEIpID0+IEJcbiAgcmVhZG9ubHkgZm9sZE1hcDogPE0+KE06IE1vbm9pZDxNPikgPT4gPEE+KGZhOiBLaW5kPEYsIEtpbmQyPEcsIEUsIEE+PiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxBLCBCPihmYTogS2luZDxGLCBLaW5kMjxHLCBFLCBBPj4sIGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiBCXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlQ29tcG9zaXRpb24yMTxGIGV4dGVuZHMgVVJJUzIsIEcgZXh0ZW5kcyBVUklTPiB7XG4gIHJlYWRvbmx5IHJlZHVjZTogPEUsIEEsIEI+KGZnYTogS2luZDI8RiwgRSwgS2luZDxHLCBBPj4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiBCXG4gIHJlYWRvbmx5IGZvbGRNYXA6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxFLCBBPihmYTogS2luZDI8RiwgRSwgS2luZDxHLCBBPj4sIGY6IChhOiBBKSA9PiBNKSA9PiBNXG4gIHJlYWRvbmx5IHJlZHVjZVJpZ2h0OiA8RSwgQSwgQj4oZmE6IEtpbmQyPEYsIEUsIEtpbmQ8RywgQT4+LCBiOiBCLCBmOiAoYTogQSwgYjogQikgPT4gQikgPT4gQlxufVxuXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGb2xkYWJsZUNvbXBvc2l0aW9uMkMxPEYgZXh0ZW5kcyBVUklTMiwgRyBleHRlbmRzIFVSSVMsIEU+IHtcbiAgcmVhZG9ubHkgcmVkdWNlOiA8QSwgQj4oZmdhOiBLaW5kMjxGLCBFLCBLaW5kPEcsIEE+PiwgYjogQiwgZjogKGI6IEIsIGE6IEEpID0+IEIpID0+IEJcbiAgcmVhZG9ubHkgZm9sZE1hcDogPE0+KE06IE1vbm9pZDxNPikgPT4gPEE+KGZhOiBLaW5kMjxGLCBFLCBLaW5kPEcsIEE+PiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxBLCBCPihmYTogS2luZDI8RiwgRSwgS2luZDxHLCBBPj4sIGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiBCXG59XG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvbGRhYmxlQ29tcG9zaXRpb24yMjxGIGV4dGVuZHMgVVJJUzIsIEcgZXh0ZW5kcyBVUklTMj4ge1xuICByZWFkb25seSByZWR1Y2U6IDxGRSwgR0UsIEEsIEI+KGZnYTogS2luZDI8RiwgRkUsIEtpbmQyPEcsIEdFLCBBPj4sIGI6IEIsIGY6IChiOiBCLCBhOiBBKSA9PiBCKSA9PiBCXG4gIHJlYWRvbmx5IGZvbGRNYXA6IDxNPihNOiBNb25vaWQ8TT4pID0+IDxGRSwgR0UsIEE+KGZhOiBLaW5kMjxGLCBGRSwgS2luZDI8RywgR0UsIEE+PiwgZjogKGE6IEEpID0+IE0pID0+IE1cbiAgcmVhZG9ubHkgcmVkdWNlUmlnaHQ6IDxGRSwgR0UsIEEsIEI+KGZhOiBLaW5kMjxGLCBGRSwgS2luZDI8RywgR0UsIEE+PiwgYjogQiwgZjogKGE6IEEsIGI6IEIpID0+IEIpID0+IEJcbn1cblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRm9sZGFibGVDb21wb3NpdGlvbjIyQzxGIGV4dGVuZHMgVVJJUzIsIEcgZXh0ZW5kcyBVUklTMiwgRT4ge1xuICByZWFkb25seSByZWR1Y2U6IDxGRSwgQSwgQj4oZmdhOiBLaW5kMjxGLCBGRSwgS2luZDI8RywgRSwgQT4+LCBiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gQikgPT4gQlxuICByZWFkb25seSBmb2xkTWFwOiA8TT4oTTogTW9ub2lkPE0+KSA9PiA8RkUsIEE+KGZhOiBLaW5kMjxGLCBGRSwgS2luZDI8RywgRSwgQT4+LCBmOiAoYTogQSkgPT4gTSkgPT4gTVxuICByZWFkb25seSByZWR1Y2VSaWdodDogPEZFLCBBLCBCPihmYTogS2luZDI8RiwgRkUsIEtpbmQyPEcsIEUsIEE+PiwgYjogQiwgZjogKGE6IEEsIGI6IEIpID0+IEIpID0+IEJcbn1cblxuLyoqXG4gKiBVc2VcbiAqXG4gKiAtIFtyZWR1Y2VdKCNyZWR1Y2UpXG4gKiAtIFtmb2xkTWFwXSgjZm9sZG1hcClcbiAqIC0gW3JlZHVjZVJpZ2h0XSgjcmVkdWNlcmlnaHQpXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2xkYWJsZUNvbXBvc2l0aW9uPEYgZXh0ZW5kcyBVUklTMiwgRyBleHRlbmRzIFVSSVMyLCBFPihcbiAgRjogRm9sZGFibGUyPEY+LFxuICBHOiBGb2xkYWJsZTJDPEcsIEU+XG4pOiBGb2xkYWJsZUNvbXBvc2l0aW9uMjJDPEYsIEcsIEU+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2xkYWJsZUNvbXBvc2l0aW9uPEYgZXh0ZW5kcyBVUklTMiwgRyBleHRlbmRzIFVSSVMyPihcbiAgRjogRm9sZGFibGUyPEY+LFxuICBHOiBGb2xkYWJsZTI8Rz5cbik6IEZvbGRhYmxlQ29tcG9zaXRpb24yMjxGLCBHPlxuLyoqIEBkZXByZWNhdGVkICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm9sZGFibGVDb21wb3NpdGlvbjxGIGV4dGVuZHMgVVJJUzIsIEcgZXh0ZW5kcyBVUklTLCBFPihcbiAgRjogRm9sZGFibGUyQzxGLCBFPixcbiAgRzogRm9sZGFibGUxPEc+XG4pOiBGb2xkYWJsZUNvbXBvc2l0aW9uMkMxPEYsIEcsIEU+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2xkYWJsZUNvbXBvc2l0aW9uPEYgZXh0ZW5kcyBVUklTMiwgRyBleHRlbmRzIFVSSVM+KFxuICBGOiBGb2xkYWJsZTI8Rj4sXG4gIEc6IEZvbGRhYmxlMTxHPlxuKTogRm9sZGFibGVDb21wb3NpdGlvbjIxPEYsIEc+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2xkYWJsZUNvbXBvc2l0aW9uPEYgZXh0ZW5kcyBVUklTLCBHIGV4dGVuZHMgVVJJUzIsIEU+KFxuICBGOiBGb2xkYWJsZTE8Rj4sXG4gIEc6IEZvbGRhYmxlMkM8RywgRT5cbik6IEZvbGRhYmxlQ29tcG9zaXRpb24xMkM8RiwgRywgRT5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZvbGRhYmxlQ29tcG9zaXRpb248RiBleHRlbmRzIFVSSVMsIEcgZXh0ZW5kcyBVUklTMj4oXG4gIEY6IEZvbGRhYmxlMTxGPixcbiAgRzogRm9sZGFibGUyPEc+XG4pOiBGb2xkYWJsZUNvbXBvc2l0aW9uMTI8RiwgRz5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZvbGRhYmxlQ29tcG9zaXRpb248RiBleHRlbmRzIFVSSVMsIEcgZXh0ZW5kcyBVUklTPihcbiAgRjogRm9sZGFibGUxPEY+LFxuICBHOiBGb2xkYWJsZTE8Rz5cbik6IEZvbGRhYmxlQ29tcG9zaXRpb24xMTxGLCBHPlxuLyoqIEBkZXByZWNhdGVkICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm9sZGFibGVDb21wb3NpdGlvbjxGLCBHPihGOiBGb2xkYWJsZTxGPiwgRzogRm9sZGFibGU8Rz4pOiBGb2xkYWJsZUNvbXBvc2l0aW9uPEYsIEc+XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2xkYWJsZUNvbXBvc2l0aW9uPEYsIEc+KEY6IEZvbGRhYmxlPEY+LCBHOiBGb2xkYWJsZTxHPik6IEZvbGRhYmxlQ29tcG9zaXRpb248RiwgRz4ge1xuICBjb25zdCBfcmVkdWNlID0gcmVkdWNlKEYsIEcpXG4gIGNvbnN0IF9mb2xkTWFwID0gZm9sZE1hcChGLCBHKVxuICBjb25zdCBfcmVkdWNlUmlnaHQgPSByZWR1Y2VSaWdodChGLCBHKVxuICByZXR1cm4ge1xuICAgIHJlZHVjZTogKGZnYSwgYiwgZikgPT4gcGlwZShmZ2EsIF9yZWR1Y2UoYiwgZikpLFxuICAgIGZvbGRNYXA6IChNKSA9PiB7XG4gICAgICBjb25zdCBmb2xkTWFwTSA9IF9mb2xkTWFwKE0pXG4gICAgICByZXR1cm4gKGZnYSwgZikgPT4gcGlwZShmZ2EsIGZvbGRNYXBNKGYpKVxuICAgIH0sXG4gICAgcmVkdWNlUmlnaHQ6IChmZ2EsIGIsIGYpID0+IHBpcGUoZmdhLCBfcmVkdWNlUmlnaHQoYiwgZikpXG4gIH1cbn1cbiJdfQ==