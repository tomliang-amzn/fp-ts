"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.chain = chain;
exports.compact = void 0;
exports.difference = difference;
exports.every = exports.empty = exports.elem = void 0;
exports.filter = filter;
exports.filterMap = filterMap;
exports.getUnionSemigroup = exports.getUnionMonoid = exports.getShow = exports.getIntersectionSemigroup = exports.getEq = exports.getDifferenceMagma = exports.fromArray = exports.foldMap = void 0;
exports.insert = insert;
exports.intersection = intersection;
exports.isSubset = exports.isEmpty = void 0;
exports.map = map;
exports.partition = partition;
exports.partitionMap = partitionMap;
exports.remove = exports.reduceRight = exports.reduce = void 0;
exports.separate = separate;
exports.toggle = exports.toArray = exports.subset = exports.some = exports.size = exports.singleton = void 0;
exports.union = union;

var _function = require("./function");

var RS = _interopRequireWildcard(require("./ReadonlySet"));

var _Separated = require("./Separated");

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/**
 * @since 2.0.0
 */

/**
 * @category instances
 * @since 2.0.0
 */
var getShow = RS.getShow;
/**
 * @category instances
 * @since 2.0.0
 */

exports.getShow = getShow;
var getEq = RS.getEq;
/**
 * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types
 * use the type constructor `F` to represent some computational context.
 *
 * @category combinators
 * @since 2.0.0
 */

exports.getEq = getEq;

function map(E) {
  var elemE = elem(E);
  return function (f) {
    return function (set) {
      var r = new Set();
      set.forEach(function (e) {
        var v = f(e);

        if (!elemE(v, r)) {
          r.add(v);
        }
      });
      return r;
    };
  };
}
/**
 * Composes computations in sequence, using the return value of one computation to determine the next computation.
 *
 * @category combinators
 * @since 2.0.0
 */


function chain(E) {
  var elemE = elem(E);
  return function (f) {
    return function (set) {
      var r = new Set();
      set.forEach(function (e) {
        f(e).forEach(function (e) {
          if (!elemE(e, r)) {
            r.add(e);
          }
        });
      });
      return r;
    };
  };
}

function filter(predicate) {
  return function (set) {
    var values = set.values();
    var e;
    var r = new Set(); // tslint:disable-next-line: strict-boolean-expressions

    while (!(e = values.next()).done) {
      var _a = e.value;

      if (predicate(_a)) {
        r.add(_a);
      }
    }

    return r;
  };
}
/**
 * @since 2.0.0
 */


function partition(predicate) {
  return function (set) {
    var values = set.values();
    var e;
    var right = new Set();
    var left = new Set(); // tslint:disable-next-line: strict-boolean-expressions

    while (!(e = values.next()).done) {
      var _a2 = e.value;

      if (predicate(_a2)) {
        right.add(_a2);
      } else {
        left.add(_a2);
      }
    }

    return (0, _Separated.separated)(left, right);
  };
} // TODO: remove non-curried overloading in v3

/**
 * Form the union of two sets
 *
 * @category combinators
 * @since 2.0.0
 */


function union(E) {
  var elemE = elem(E);
  return function (me, that) {
    if (that === undefined) {
      var unionE = union(E);
      return function (that) {
        return unionE(me, that);
      };
    }

    if (isEmpty(me)) {
      return that;
    }

    if (isEmpty(that)) {
      return me;
    }

    var r = new Set(me);
    that.forEach(function (e) {
      if (!elemE(e, r)) {
        r.add(e);
      }
    });
    return r;
  };
} // TODO: remove non-curried overloading in v3

/**
 * The set of elements which are in both the first and second set
 *
 * @category combinators
 * @since 2.0.0
 */


function intersection(E) {
  var elemE = elem(E);
  return function (me, that) {
    if (that === undefined) {
      var intersectionE = intersection(E);
      return function (that) {
        return intersectionE(that, me);
      };
    }

    if (isEmpty(me) || isEmpty(that)) {
      return new Set();
    }

    var r = new Set();
    me.forEach(function (e) {
      if (elemE(e, that)) {
        r.add(e);
      }
    });
    return r;
  };
}
/**
 * @since 2.0.0
 */


function partitionMap(EB, EC) {
  return function (f) {
    return function (set) {
      var values = set.values();
      var e;
      var left = new Set();
      var right = new Set();
      var hasB = elem(EB);
      var hasC = elem(EC); // tslint:disable-next-line: strict-boolean-expressions

      while (!(e = values.next()).done) {
        var v = f(e.value);

        switch (v._tag) {
          case 'Left':
            if (!hasB(v.left, left)) {
              left.add(v.left);
            }

            break;

          case 'Right':
            if (!hasC(v.right, right)) {
              right.add(v.right);
            }

            break;
        }
      }

      return (0, _Separated.separated)(left, right);
    };
  };
} // TODO: remove non-curried overloading in v3

/**
 * Form the set difference (`x` - `y`)
 *
 * @example
 * import { difference } from 'fp-ts/Set'
 * import * as N from 'fp-ts/number'
 * import { pipe } from 'fp-ts/function'
 *
 * assert.deepStrictEqual(pipe(new Set([1, 2]), difference(N.Eq)(new Set([1, 3]))), new Set([2]))
 *
 * @category combinators
 * @since 2.0.0
 */


function difference(E) {
  var elemE = elem(E);
  return function (me, that) {
    if (that === undefined) {
      var differenceE = difference(E);
      return function (that) {
        return differenceE(that, me);
      };
    }

    return filter(function (a) {
      return !elemE(a, that);
    })(me);
  };
}
/**
 * @category instances
 * @since 2.11.0
 */


var getUnionSemigroup = function getUnionSemigroup(E) {
  return {
    concat: union(E)
  };
};
/**
 * @category instances
 * @since 2.0.0
 */


exports.getUnionSemigroup = getUnionSemigroup;

var getUnionMonoid = function getUnionMonoid(E) {
  return {
    concat: getUnionSemigroup(E).concat,
    empty: new Set()
  };
};
/**
 * @category instances
 * @since 2.0.0
 */


exports.getUnionMonoid = getUnionMonoid;

var getIntersectionSemigroup = function getIntersectionSemigroup(E) {
  return {
    concat: intersection(E)
  };
};
/**
 * @category instances
 * @since 2.11.0
 */


exports.getIntersectionSemigroup = getIntersectionSemigroup;

var getDifferenceMagma = function getDifferenceMagma(E) {
  return {
    concat: difference(E)
  };
};
/**
 * @since 2.0.0
 */


exports.getDifferenceMagma = getDifferenceMagma;
var reduce = RS.reduce;
/**
 * @since 2.0.0
 */

exports.reduce = reduce;
var foldMap = RS.foldMap;
/**
 * @since 2.11.0
 */

exports.foldMap = foldMap;
var reduceRight = RS.reduceRight;
/**
 * Create a set with one element
 *
 * @category constructors
 * @since 2.0.0
 */

exports.reduceRight = reduceRight;

var singleton = function singleton(a) {
  return new Set([a]);
};
/**
 * Insert a value into a set
 *
 * @category combinators
 * @since 2.0.0
 */


exports.singleton = singleton;

function insert(E) {
  var elemE = elem(E);
  return function (a) {
    return function (set) {
      if (!elemE(a)(set)) {
        var r = new Set(set);
        r.add(a);
        return r;
      } else {
        return set;
      }
    };
  };
}
/**
 * Delete a value from a set
 *
 * @category combinators
 * @since 2.0.0
 */


var remove = function remove(E) {
  return function (a) {
    return function (set) {
      return filter(function (ax) {
        return !E.equals(a, ax);
      })(set);
    };
  };
};
/**
 * Checks an element is a member of a set;
 * If yes, removes the value from the set
 * If no, inserts the value to the set
 *
 * @category combinators
 * @since 2.5.0
 */


exports.remove = remove;

var toggle = function toggle(E) {
  var elemE = elem(E);
  var removeE = remove(E);
  var insertE = insert(E);
  return function (a) {
    return function (set) {
      return (elemE(a, set) ? removeE : insertE)(a)(set);
    };
  };
};
/**
 * Create a set from an array
 *
 * @category constructors
 * @since 2.0.0
 */


exports.toggle = toggle;

var fromArray = function fromArray(E) {
  return function (as) {
    var len = as.length;
    var out = new Set();
    var has = elem(E);

    for (var i = 0; i < len; i++) {
      var _a3 = as[i];

      if (!has(_a3, out)) {
        out.add(_a3);
      }
    }

    return out;
  };
};
/**
 * @category combinators
 * @since 2.0.0
 */


exports.fromArray = fromArray;

var compact = function compact(E) {
  return filterMap(E)(_function.identity);
};
/**
 * @since 2.0.0
 */


exports.compact = compact;

function separate(EE, EA) {
  return function (fa) {
    var elemEE = elem(EE);
    var elemEA = elem(EA);
    var left = new Set();
    var right = new Set();
    fa.forEach(function (e) {
      switch (e._tag) {
        case 'Left':
          if (!elemEE(e.left, left)) {
            left.add(e.left);
          }

          break;

        case 'Right':
          if (!elemEA(e.right, right)) {
            right.add(e.right);
          }

          break;
      }
    });
    return (0, _Separated.separated)(left, right);
  };
}
/**
 * @category combinators
 * @since 2.0.0
 */


function filterMap(E) {
  var elemE = elem(E);
  return function (f) {
    return function (fa) {
      var r = new Set();
      fa.forEach(function (a) {
        var ob = f(a);

        if (ob._tag === 'Some' && !elemE(ob.value, r)) {
          r.add(ob.value);
        }
      });
      return r;
    };
  };
} // -------------------------------------------------------------------------------------
// utils
// -------------------------------------------------------------------------------------

/**
 * @since 2.0.0
 */


var empty = new Set();
/**
 * Test whether a `Set` is empty.
 *
 * @since 2.10.0
 */

exports.empty = empty;

var isEmpty = function isEmpty(set) {
  return set.size === 0;
};
/**
 * Calculate the number of elements in a `Set`.
 *
 * @since 2.10.0
 */


exports.isEmpty = isEmpty;

var size = function size(set) {
  return set.size;
};
/**
 * @since 2.0.0
 */


exports.size = size;
var some = RS.some;
/**
 * @since 2.0.0
 */

exports.some = some;
var every = RS.every;
/**
 * @since 2.10.0
 */

exports.every = every;
var isSubset = RS.isSubset; // TODO: remove non-curried overloading in v3

/**
 * Test if a value is a member of a set
 *
 * @since 2.0.0
 */

exports.isSubset = isSubset;
var elem = RS.elem;
/**
 * Get a sorted `Array` of the values contained in a `Set`.
 *
 * @since 2.0.0
 */

exports.elem = elem;

var toArray = function toArray(O) {
  return function (set) {
    var out = [];
    set.forEach(function (e) {
      return out.push(e);
    });
    return out.sort(O.compare);
  };
}; // -------------------------------------------------------------------------------------
// deprecated
// -------------------------------------------------------------------------------------

/**
 * Use [`isSubset`](#issubset) instead.
 *
 * @since 2.0.0
 * @deprecated
 */


exports.toArray = toArray;
var subset = RS.isSubset;
exports.subset = subset;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mcC10cy9TZXQudHMiXSwibmFtZXMiOlsiZ2V0U2hvdyIsIlJTIiwiZ2V0RXEiLCJtYXAiLCJFIiwiZWxlbUUiLCJlbGVtIiwiZiIsInNldCIsInIiLCJTZXQiLCJmb3JFYWNoIiwiZSIsInYiLCJhZGQiLCJjaGFpbiIsImZpbHRlciIsInByZWRpY2F0ZSIsInZhbHVlcyIsIm5leHQiLCJkb25lIiwiYSIsInZhbHVlIiwicGFydGl0aW9uIiwicmlnaHQiLCJsZWZ0IiwidW5pb24iLCJtZSIsInRoYXQiLCJ1bmRlZmluZWQiLCJ1bmlvbkUiLCJpc0VtcHR5IiwiaW50ZXJzZWN0aW9uIiwiaW50ZXJzZWN0aW9uRSIsInBhcnRpdGlvbk1hcCIsIkVCIiwiRUMiLCJoYXNCIiwiaGFzQyIsIl90YWciLCJkaWZmZXJlbmNlIiwiZGlmZmVyZW5jZUUiLCJnZXRVbmlvblNlbWlncm91cCIsImNvbmNhdCIsImdldFVuaW9uTW9ub2lkIiwiZW1wdHkiLCJnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAiLCJnZXREaWZmZXJlbmNlTWFnbWEiLCJyZWR1Y2UiLCJmb2xkTWFwIiwicmVkdWNlUmlnaHQiLCJzaW5nbGV0b24iLCJpbnNlcnQiLCJyZW1vdmUiLCJheCIsImVxdWFscyIsInRvZ2dsZSIsInJlbW92ZUUiLCJpbnNlcnRFIiwiZnJvbUFycmF5IiwiYXMiLCJsZW4iLCJsZW5ndGgiLCJvdXQiLCJoYXMiLCJpIiwiY29tcGFjdCIsImZpbHRlck1hcCIsImlkZW50aXR5Iiwic2VwYXJhdGUiLCJFRSIsIkVBIiwiZmEiLCJlbGVtRUUiLCJlbGVtRUEiLCJvYiIsInNpemUiLCJzb21lIiwiZXZlcnkiLCJpc1N1YnNldCIsInRvQXJyYXkiLCJPIiwicHVzaCIsInNvcnQiLCJjb21wYXJlIiwic3Vic2V0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBS0E7O0FBTUE7O0FBR0E7Ozs7OztBQWRBO0FBQ0E7QUFDQTs7QUFlQTtBQUNB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QzZFLEtBQTNFO0FBRVA7QUFDQTtBQUNBOzs7QUFDTyxJQUFNQyxRQUFvRSxHQUFHOUUsRUFBRSxDQUFDOEUsUUFBaEYsQyxDQUVQOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNPLElBQU16RSxJQUtaLEdBQUdMLEVBQUUsQ0FBQ0ssSUFMQTtBQU9QO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDTyxJQUFNMEUsT0FBTyxHQUFHLFNBQVZBLE9BQVUsQ0FBSUMsQ0FBSjtBQUFBLFNBQWtCLFVBQUN6RSxHQUFELEVBQTJCO0FBQ2xFLFFBQU11RCxHQUFhLEdBQUcsRUFBdEI7QUFDQXZELElBQUFBLEdBQUcsQ0FBQ0csT0FBSixDQUFZLFVBQUNDLENBQUQ7QUFBQSxhQUFPbUQsR0FBRyxDQUFDbUIsSUFBSixDQUFTdEUsQ0FBVCxDQUFQO0FBQUEsS0FBWjtBQUNBLFdBQU9tRCxHQUFHLENBQUNvQixJQUFKLENBQVNGLENBQUMsQ0FBQ0csT0FBWCxDQUFQO0FBQ0QsR0FKc0I7QUFBQSxDQUFoQixDLENBTVA7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNPLElBQU1DLE1BS1osR0FBR3BGLEVBQUUsQ0FBQzhFLFFBTEEiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5pbXBvcnQgeyBFaXRoZXIgfSBmcm9tICcuL0VpdGhlcidcbmltcG9ydCB7IEVxIH0gZnJvbSAnLi9FcSdcbmltcG9ydCB7IGlkZW50aXR5IH0gZnJvbSAnLi9mdW5jdGlvbidcbmltcG9ydCB7IE1hZ21hIH0gZnJvbSAnLi9NYWdtYSdcbmltcG9ydCB7IE1vbm9pZCB9IGZyb20gJy4vTW9ub2lkJ1xuaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnLi9PcHRpb24nXG5pbXBvcnQgeyBPcmQgfSBmcm9tICcuL09yZCdcbmltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJy4vUHJlZGljYXRlJ1xuaW1wb3J0ICogYXMgUlMgZnJvbSAnLi9SZWFkb25seVNldCdcbmltcG9ydCB7IFJlZmluZW1lbnQgfSBmcm9tICcuL1JlZmluZW1lbnQnXG5pbXBvcnQgeyBTZW1pZ3JvdXAgfSBmcm9tICcuL1NlbWlncm91cCdcbmltcG9ydCB7IHNlcGFyYXRlZCwgU2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnXG5pbXBvcnQgeyBTaG93IH0gZnJvbSAnLi9TaG93J1xuXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgY29uc3QgZ2V0U2hvdzogPEE+KFM6IFNob3c8QT4pID0+IFNob3c8U2V0PEE+PiA9IFJTLmdldFNob3dcblxuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IGdldEVxOiA8QT4oRTogRXE8QT4pID0+IEVxPFNldDxBPj4gPSBSUy5nZXRFcVxuXG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcDxCPihFOiBFcTxCPik6IDxBPihmOiAoeDogQSkgPT4gQikgPT4gKHNldDogU2V0PEE+KSA9PiBTZXQ8Qj4ge1xuICBjb25zdCBlbGVtRSA9IGVsZW0oRSlcbiAgcmV0dXJuIChmKSA9PiAoc2V0KSA9PiB7XG4gICAgY29uc3QgciA9IG5ldyBTZXQ8Qj4oKVxuICAgIHNldC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBjb25zdCB2ID0gZihlKVxuICAgICAgaWYgKCFlbGVtRSh2LCByKSkge1xuICAgICAgICByLmFkZCh2KVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHJcbiAgfVxufVxuXG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uLlxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGFpbjxCPihFOiBFcTxCPik6IDxBPihmOiAoeDogQSkgPT4gU2V0PEI+KSA9PiAoc2V0OiBTZXQ8QT4pID0+IFNldDxCPiB7XG4gIGNvbnN0IGVsZW1FID0gZWxlbShFKVxuICByZXR1cm4gKGYpID0+IChzZXQpID0+IHtcbiAgICBjb25zdCByID0gbmV3IFNldDxCPigpXG4gICAgc2V0LmZvckVhY2goKGUpID0+IHtcbiAgICAgIGYoZSkuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgICBpZiAoIWVsZW1FKGUsIHIpKSB7XG4gICAgICAgICAgci5hZGQoZSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICAgIHJldHVybiByXG4gIH1cbn1cblxuaW50ZXJmYWNlIE5leHQ8QT4ge1xuICByZWFkb25seSBkb25lPzogYm9vbGVhblxuICByZWFkb25seSB2YWx1ZTogQVxufVxuXG4vKipcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXI8QSwgQiBleHRlbmRzIEE+KHJlZmluZW1lbnQ6IFJlZmluZW1lbnQ8QSwgQj4pOiAoc2V0OiBTZXQ8QT4pID0+IFNldDxCPlxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlcjxBPihwcmVkaWNhdGU6IFByZWRpY2F0ZTxBPik6IDxCIGV4dGVuZHMgQT4oc2V0OiBTZXQ8Qj4pID0+IFNldDxCPlxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlcjxBPihwcmVkaWNhdGU6IFByZWRpY2F0ZTxBPik6IChzZXQ6IFNldDxBPikgPT4gU2V0PEE+XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyPEE+KHByZWRpY2F0ZTogUHJlZGljYXRlPEE+KTogKHNldDogU2V0PEE+KSA9PiBTZXQ8QT4ge1xuICByZXR1cm4gKHNldDogU2V0PEE+KSA9PiB7XG4gICAgY29uc3QgdmFsdWVzID0gc2V0LnZhbHVlcygpXG4gICAgbGV0IGU6IE5leHQ8QT5cbiAgICBjb25zdCByID0gbmV3IFNldDxBPigpXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBzdHJpY3QtYm9vbGVhbi1leHByZXNzaW9uc1xuICAgIHdoaWxlICghKGUgPSB2YWx1ZXMubmV4dCgpKS5kb25lKSB7XG4gICAgICBjb25zdCBhID0gZS52YWx1ZVxuICAgICAgaWYgKHByZWRpY2F0ZShhKSkge1xuICAgICAgICByLmFkZChhKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gclxuICB9XG59XG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJ0aXRpb248QSwgQiBleHRlbmRzIEE+KHJlZmluZW1lbnQ6IFJlZmluZW1lbnQ8QSwgQj4pOiAoc2V0OiBTZXQ8QT4pID0+IFNlcGFyYXRlZDxTZXQ8QT4sIFNldDxCPj5cbmV4cG9ydCBmdW5jdGlvbiBwYXJ0aXRpb248QT4ocHJlZGljYXRlOiBQcmVkaWNhdGU8QT4pOiA8QiBleHRlbmRzIEE+KHNldDogU2V0PEI+KSA9PiBTZXBhcmF0ZWQ8U2V0PEI+LCBTZXQ8Qj4+XG5leHBvcnQgZnVuY3Rpb24gcGFydGl0aW9uPEE+KHByZWRpY2F0ZTogUHJlZGljYXRlPEE+KTogKHNldDogU2V0PEE+KSA9PiBTZXBhcmF0ZWQ8U2V0PEE+LCBTZXQ8QT4+XG5leHBvcnQgZnVuY3Rpb24gcGFydGl0aW9uPEE+KHByZWRpY2F0ZTogUHJlZGljYXRlPEE+KTogKHNldDogU2V0PEE+KSA9PiBTZXBhcmF0ZWQ8U2V0PEE+LCBTZXQ8QT4+IHtcbiAgcmV0dXJuIChzZXQ6IFNldDxBPikgPT4ge1xuICAgIGNvbnN0IHZhbHVlcyA9IHNldC52YWx1ZXMoKVxuICAgIGxldCBlOiBOZXh0PEE+XG4gICAgY29uc3QgcmlnaHQgPSBuZXcgU2V0PEE+KClcbiAgICBjb25zdCBsZWZ0ID0gbmV3IFNldDxBPigpXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBzdHJpY3QtYm9vbGVhbi1leHByZXNzaW9uc1xuICAgIHdoaWxlICghKGUgPSB2YWx1ZXMubmV4dCgpKS5kb25lKSB7XG4gICAgICBjb25zdCBhID0gZS52YWx1ZVxuICAgICAgaWYgKHByZWRpY2F0ZShhKSkge1xuICAgICAgICByaWdodC5hZGQoYSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxlZnQuYWRkKGEpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpXG4gIH1cbn1cblxuLy8gVE9ETzogcmVtb3ZlIG5vbi1jdXJyaWVkIG92ZXJsb2FkaW5nIGluIHYzXG4vKipcbiAqIEZvcm0gdGhlIHVuaW9uIG9mIHR3byBzZXRzXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uPEE+KFxuICBFOiBFcTxBPlxuKToge1xuICAodGhhdDogU2V0PEE+KTogKG1lOiBTZXQ8QT4pID0+IFNldDxBPlxuICAobWU6IFNldDxBPiwgdGhhdDogU2V0PEE+KTogU2V0PEE+XG59XG5leHBvcnQgZnVuY3Rpb24gdW5pb248QT4oRTogRXE8QT4pOiAobWU6IFNldDxBPiwgdGhhdD86IFNldDxBPikgPT4gU2V0PEE+IHwgKChtZTogU2V0PEE+KSA9PiBTZXQ8QT4pIHtcbiAgY29uc3QgZWxlbUUgPSBlbGVtKEUpXG4gIHJldHVybiAobWUsIHRoYXQ/KSA9PiB7XG4gICAgaWYgKHRoYXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgdW5pb25FID0gdW5pb24oRSlcbiAgICAgIHJldHVybiAodGhhdCkgPT4gdW5pb25FKG1lLCB0aGF0KVxuICAgIH1cbiAgICBpZiAoaXNFbXB0eShtZSkpIHtcbiAgICAgIHJldHVybiB0aGF0XG4gICAgfVxuICAgIGlmIChpc0VtcHR5KHRoYXQpKSB7XG4gICAgICByZXR1cm4gbWVcbiAgICB9XG4gICAgY29uc3QgciA9IG5ldyBTZXQobWUpXG4gICAgdGhhdC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBpZiAoIWVsZW1FKGUsIHIpKSB7XG4gICAgICAgIHIuYWRkKGUpXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gclxuICB9XG59XG5cbi8vIFRPRE86IHJlbW92ZSBub24tY3VycmllZCBvdmVybG9hZGluZyBpbiB2M1xuLyoqXG4gKiBUaGUgc2V0IG9mIGVsZW1lbnRzIHdoaWNoIGFyZSBpbiBib3RoIHRoZSBmaXJzdCBhbmQgc2Vjb25kIHNldFxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb248QT4oXG4gIEU6IEVxPEE+XG4pOiB7XG4gICh0aGF0OiBTZXQ8QT4pOiAobWU6IFNldDxBPikgPT4gU2V0PEE+XG4gIChtZTogU2V0PEE+LCB0aGF0OiBTZXQ8QT4pOiBTZXQ8QT5cbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb248QT4oRTogRXE8QT4pOiAobWU6IFNldDxBPiwgdGhhdD86IFNldDxBPikgPT4gU2V0PEE+IHwgKCh0aGF0OiBTZXQ8QT4pID0+IFNldDxBPikge1xuICBjb25zdCBlbGVtRSA9IGVsZW0oRSlcbiAgcmV0dXJuIChtZSwgdGhhdD8pID0+IHtcbiAgICBpZiAodGhhdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpXG4gICAgICByZXR1cm4gKHRoYXQpID0+IGludGVyc2VjdGlvbkUodGhhdCwgbWUpXG4gICAgfVxuICAgIGlmIChpc0VtcHR5KG1lKSB8fCBpc0VtcHR5KHRoYXQpKSB7XG4gICAgICByZXR1cm4gbmV3IFNldCgpXG4gICAgfVxuICAgIGNvbnN0IHIgPSBuZXcgU2V0PEE+KClcbiAgICBtZS5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBpZiAoZWxlbUUoZSwgdGhhdCkpIHtcbiAgICAgICAgci5hZGQoZSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiByXG4gIH1cbn1cblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnRpdGlvbk1hcDxCLCBDPihcbiAgRUI6IEVxPEI+LFxuICBFQzogRXE8Qz5cbik6IDxBPihmOiAoYTogQSkgPT4gRWl0aGVyPEIsIEM+KSA9PiAoc2V0OiBTZXQ8QT4pID0+IFNlcGFyYXRlZDxTZXQ8Qj4sIFNldDxDPj4ge1xuICByZXR1cm4gPEE+KGY6IChhOiBBKSA9PiBFaXRoZXI8QiwgQz4pID0+IChzZXQ6IFNldDxBPikgPT4ge1xuICAgIGNvbnN0IHZhbHVlcyA9IHNldC52YWx1ZXMoKVxuICAgIGxldCBlOiBOZXh0PEE+XG4gICAgY29uc3QgbGVmdCA9IG5ldyBTZXQ8Qj4oKVxuICAgIGNvbnN0IHJpZ2h0ID0gbmV3IFNldDxDPigpXG4gICAgY29uc3QgaGFzQiA9IGVsZW0oRUIpXG4gICAgY29uc3QgaGFzQyA9IGVsZW0oRUMpXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBzdHJpY3QtYm9vbGVhbi1leHByZXNzaW9uc1xuICAgIHdoaWxlICghKGUgPSB2YWx1ZXMubmV4dCgpKS5kb25lKSB7XG4gICAgICBjb25zdCB2ID0gZihlLnZhbHVlKVxuICAgICAgc3dpdGNoICh2Ll90YWcpIHtcbiAgICAgICAgY2FzZSAnTGVmdCc6XG4gICAgICAgICAgaWYgKCFoYXNCKHYubGVmdCwgbGVmdCkpIHtcbiAgICAgICAgICAgIGxlZnQuYWRkKHYubGVmdClcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAnUmlnaHQnOlxuICAgICAgICAgIGlmICghaGFzQyh2LnJpZ2h0LCByaWdodCkpIHtcbiAgICAgICAgICAgIHJpZ2h0LmFkZCh2LnJpZ2h0KVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KVxuICB9XG59XG5cbi8vIFRPRE86IHJlbW92ZSBub24tY3VycmllZCBvdmVybG9hZGluZyBpbiB2M1xuLyoqXG4gKiBGb3JtIHRoZSBzZXQgZGlmZmVyZW5jZSAoYHhgIC0gYHlgKVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkaWZmZXJlbmNlIH0gZnJvbSAnZnAtdHMvU2V0J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKG5ldyBTZXQoWzEsIDJdKSwgZGlmZmVyZW5jZShOLkVxKShuZXcgU2V0KFsxLCAzXSkpKSwgbmV3IFNldChbMl0pKVxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlPEE+KFxuICBFOiBFcTxBPlxuKToge1xuICAodGhhdDogU2V0PEE+KTogKG1lOiBTZXQ8QT4pID0+IFNldDxBPlxuICAobWU6IFNldDxBPiwgdGhhdDogU2V0PEE+KTogU2V0PEE+XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZTxBPihFOiBFcTxBPik6IChtZTogU2V0PEE+LCB0aGF0PzogU2V0PEE+KSA9PiBTZXQ8QT4gfCAoKG1lOiBTZXQ8QT4pID0+IFNldDxBPikge1xuICBjb25zdCBlbGVtRSA9IGVsZW0oRSlcbiAgcmV0dXJuIChtZSwgdGhhdD8pID0+IHtcbiAgICBpZiAodGhhdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSlcbiAgICAgIHJldHVybiAodGhhdCkgPT4gZGlmZmVyZW5jZUUodGhhdCwgbWUpXG4gICAgfVxuICAgIHJldHVybiBmaWx0ZXIoKGE6IEEpID0+ICFlbGVtRShhLCB0aGF0KSkobWUpXG4gIH1cbn1cblxuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRVbmlvblNlbWlncm91cCA9IDxBPihFOiBFcTxBPik6IFNlbWlncm91cDxTZXQ8QT4+ID0+ICh7XG4gIGNvbmNhdDogdW5pb24oRSlcbn0pXG5cbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRVbmlvbk1vbm9pZCA9IDxBPihFOiBFcTxBPik6IE1vbm9pZDxTZXQ8QT4+ID0+ICh7XG4gIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICBlbXB0eTogbmV3IFNldCgpXG59KVxuXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgY29uc3QgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwID0gPEE+KEU6IEVxPEE+KTogU2VtaWdyb3VwPFNldDxBPj4gPT4gKHtcbiAgY29uY2F0OiBpbnRlcnNlY3Rpb24oRSlcbn0pXG5cbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgY29uc3QgZ2V0RGlmZmVyZW5jZU1hZ21hID0gPEE+KEU6IEVxPEE+KTogTWFnbWE8U2V0PEE+PiA9PiAoe1xuICBjb25jYXQ6IGRpZmZlcmVuY2UoRSlcbn0pXG5cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBjb25zdCByZWR1Y2U6IDxBPihPOiBPcmQ8QT4pID0+IDxCPihiOiBCLCBmOiAoYjogQiwgYTogQSkgPT4gQikgPT4gKGZhOiBTZXQ8QT4pID0+IEIgPSBSUy5yZWR1Y2VcblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IGZvbGRNYXA6IDxBLCBNPihPOiBPcmQ8QT4sIE06IE1vbm9pZDxNPikgPT4gKGY6IChhOiBBKSA9PiBNKSA9PiAoZmE6IFNldDxBPikgPT4gTSA9IFJTLmZvbGRNYXBcblxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCBjb25zdCByZWR1Y2VSaWdodDogPEE+KE86IE9yZDxBPikgPT4gPEI+KGI6IEIsIGY6IChhOiBBLCBiOiBCKSA9PiBCKSA9PiAoZmE6IFNldDxBPikgPT4gQiA9IFJTLnJlZHVjZVJpZ2h0XG5cbi8qKlxuICogQ3JlYXRlIGEgc2V0IHdpdGggb25lIGVsZW1lbnRcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IHNpbmdsZXRvbiA9IDxBPihhOiBBKTogU2V0PEE+ID0+IG5ldyBTZXQoW2FdKVxuXG4vKipcbiAqIEluc2VydCBhIHZhbHVlIGludG8gYSBzZXRcbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0PEE+KEU6IEVxPEE+KTogKGE6IEEpID0+IChzZXQ6IFNldDxBPikgPT4gU2V0PEE+IHtcbiAgY29uc3QgZWxlbUUgPSBlbGVtKEUpXG4gIHJldHVybiAoYSkgPT4gKHNldCkgPT4ge1xuICAgIGlmICghZWxlbUUoYSkoc2V0KSkge1xuICAgICAgY29uc3QgciA9IG5ldyBTZXQoc2V0KVxuICAgICAgci5hZGQoYSlcbiAgICAgIHJldHVybiByXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzZXRcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBEZWxldGUgYSB2YWx1ZSBmcm9tIGEgc2V0XG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IHJlbW92ZSA9IDxBPihFOiBFcTxBPikgPT4gKGE6IEEpID0+IChzZXQ6IFNldDxBPik6IFNldDxBPiA9PiBmaWx0ZXIoKGF4OiBBKSA9PiAhRS5lcXVhbHMoYSwgYXgpKShzZXQpXG5cbi8qKlxuICogQ2hlY2tzIGFuIGVsZW1lbnQgaXMgYSBtZW1iZXIgb2YgYSBzZXQ7XG4gKiBJZiB5ZXMsIHJlbW92ZXMgdGhlIHZhbHVlIGZyb20gdGhlIHNldFxuICogSWYgbm8sIGluc2VydHMgdGhlIHZhbHVlIHRvIHRoZSBzZXRcbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgY29uc3QgdG9nZ2xlID0gPEE+KEU6IEVxPEE+KTogKChhOiBBKSA9PiAoc2V0OiBTZXQ8QT4pID0+IFNldDxBPikgPT4ge1xuICBjb25zdCBlbGVtRSA9IGVsZW0oRSlcbiAgY29uc3QgcmVtb3ZlRSA9IHJlbW92ZShFKVxuICBjb25zdCBpbnNlcnRFID0gaW5zZXJ0KEUpXG4gIHJldHVybiAoYSkgPT4gKHNldCkgPT4gKGVsZW1FKGEsIHNldCkgPyByZW1vdmVFIDogaW5zZXJ0RSkoYSkoc2V0KVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIHNldCBmcm9tIGFuIGFycmF5XG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBjb25zdCBmcm9tQXJyYXkgPSA8QT4oRTogRXE8QT4pID0+IChhczogQXJyYXk8QT4pOiBTZXQ8QT4gPT4ge1xuICBjb25zdCBsZW4gPSBhcy5sZW5ndGhcbiAgY29uc3Qgb3V0ID0gbmV3IFNldDxBPigpXG4gIGNvbnN0IGhhcyA9IGVsZW0oRSlcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgIGNvbnN0IGEgPSBhc1tpXVxuICAgIGlmICghaGFzKGEsIG91dCkpIHtcbiAgICAgIG91dC5hZGQoYSlcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG4vKipcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBjb25zdCBjb21wYWN0ID0gPEE+KEU6IEVxPEE+KTogKChmYTogU2V0PE9wdGlvbjxBPj4pID0+IFNldDxBPikgPT4gZmlsdGVyTWFwKEUpKGlkZW50aXR5KVxuXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gc2VwYXJhdGU8RSwgQT4oRUU6IEVxPEU+LCBFQTogRXE8QT4pOiAoZmE6IFNldDxFaXRoZXI8RSwgQT4+KSA9PiBTZXBhcmF0ZWQ8U2V0PEU+LCBTZXQ8QT4+IHtcbiAgcmV0dXJuIChmYSkgPT4ge1xuICAgIGNvbnN0IGVsZW1FRSA9IGVsZW0oRUUpXG4gICAgY29uc3QgZWxlbUVBID0gZWxlbShFQSlcbiAgICBjb25zdCBsZWZ0OiBTZXQ8RT4gPSBuZXcgU2V0KClcbiAgICBjb25zdCByaWdodDogU2V0PEE+ID0gbmV3IFNldCgpXG4gICAgZmEuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgc3dpdGNoIChlLl90YWcpIHtcbiAgICAgICAgY2FzZSAnTGVmdCc6XG4gICAgICAgICAgaWYgKCFlbGVtRUUoZS5sZWZ0LCBsZWZ0KSkge1xuICAgICAgICAgICAgbGVmdC5hZGQoZS5sZWZ0KVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdSaWdodCc6XG4gICAgICAgICAgaWYgKCFlbGVtRUEoZS5yaWdodCwgcmlnaHQpKSB7XG4gICAgICAgICAgICByaWdodC5hZGQoZS5yaWdodClcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpXG4gIH1cbn1cblxuLyoqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyTWFwPEI+KEU6IEVxPEI+KTogPEE+KGY6IChhOiBBKSA9PiBPcHRpb248Qj4pID0+IChmYTogU2V0PEE+KSA9PiBTZXQ8Qj4ge1xuICBjb25zdCBlbGVtRSA9IGVsZW0oRSlcbiAgcmV0dXJuIChmKSA9PiAoZmEpID0+IHtcbiAgICBjb25zdCByOiBTZXQ8Qj4gPSBuZXcgU2V0KClcbiAgICBmYS5mb3JFYWNoKChhKSA9PiB7XG4gICAgICBjb25zdCBvYiA9IGYoYSlcbiAgICAgIGlmIChvYi5fdGFnID09PSAnU29tZScgJiYgIWVsZW1FKG9iLnZhbHVlLCByKSkge1xuICAgICAgICByLmFkZChvYi52YWx1ZSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiByXG4gIH1cbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IGVtcHR5OiBTZXQ8bmV2ZXI+ID0gbmV3IFNldCgpXG5cbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFNldGAgaXMgZW1wdHkuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgY29uc3QgaXNFbXB0eSA9IDxBPihzZXQ6IFNldDxBPik6IGJvb2xlYW4gPT4gc2V0LnNpemUgPT09IDBcblxuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBTZXRgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IGNvbnN0IHNpemUgPSA8QT4oc2V0OiBTZXQ8QT4pOiBudW1iZXIgPT4gc2V0LnNpemVcblxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IHNvbWU6IDxBPihwcmVkaWNhdGU6IFByZWRpY2F0ZTxBPikgPT4gKHNldDogU2V0PEE+KSA9PiBib29sZWFuID0gUlMuc29tZVxuXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgY29uc3QgZXZlcnk6IDxBPihwcmVkaWNhdGU6IFByZWRpY2F0ZTxBPikgPT4gKHNldDogU2V0PEE+KSA9PiBib29sZWFuID0gUlMuZXZlcnlcblxuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCBjb25zdCBpc1N1YnNldDogPEE+KEU6IEVxPEE+KSA9PiAodGhhdDogU2V0PEE+KSA9PiAobWU6IFNldDxBPikgPT4gYm9vbGVhbiA9IFJTLmlzU3Vic2V0XG5cbi8vIFRPRE86IHJlbW92ZSBub24tY3VycmllZCBvdmVybG9hZGluZyBpbiB2M1xuLyoqXG4gKiBUZXN0IGlmIGEgdmFsdWUgaXMgYSBtZW1iZXIgb2YgYSBzZXRcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGNvbnN0IGVsZW06IDxBPihcbiAgRTogRXE8QT5cbikgPT4ge1xuICAoYTogQSk6IChzZXQ6IFNldDxBPikgPT4gYm9vbGVhblxuICAoYTogQSwgc2V0OiBTZXQ8QT4pOiBib29sZWFuXG59ID0gUlMuZWxlbVxuXG4vKipcbiAqIEdldCBhIHNvcnRlZCBgQXJyYXlgIG9mIHRoZSB2YWx1ZXMgY29udGFpbmVkIGluIGEgYFNldGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBjb25zdCB0b0FycmF5ID0gPEE+KE86IE9yZDxBPikgPT4gKHNldDogU2V0PEE+KTogQXJyYXk8QT4gPT4ge1xuICBjb25zdCBvdXQ6IEFycmF5PEE+ID0gW11cbiAgc2V0LmZvckVhY2goKGUpID0+IG91dC5wdXNoKGUpKVxuICByZXR1cm4gb3V0LnNvcnQoTy5jb21wYXJlKVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8qKlxuICogVXNlIFtgaXNTdWJzZXRgXSgjaXNzdWJzZXQpIGluc3RlYWQuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgY29uc3Qgc3Vic2V0OiA8QT4oXG4gIEU6IEVxPEE+XG4pID0+IHtcbiAgKHRoYXQ6IFNldDxBPik6IChtZTogU2V0PEE+KSA9PiBib29sZWFuXG4gIChtZTogU2V0PEE+LCB0aGF0OiBTZXQ8QT4pOiBib29sZWFuXG59ID0gUlMuaXNTdWJzZXRcbiJdfQ==